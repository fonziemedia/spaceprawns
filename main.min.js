function setGameDimensions(){var a=$("#gamearea"),b=$("canvas"),c=window.innerWidth,d=window.innerHeight;game.isMobile||(c=parseInt(a.css("width"))*pixelRatio),b.attr("width",c*pixelRatio),b.attr("height",d*pixelRatio),game.contextEnemies.scale(pixelRatio,pixelRatio),game.contextPlayer.scale(pixelRatio,pixelRatio),game.width=c,game.height=d,game.outerLeft=-Math.round(.1*game.width),game.outerRight=Math.round(game.width+.1*game.width),game.outerTop=-Math.round(.1*game.height),game.outerBottom=Math.round(game.height+.1*game.height)}function sprite(a,b,c,d,e,f,g,h){this.image=a,this.imageSize=b,this.frameWidth=c,this.frameHeight=d,this.startFrame=e,this.endFrame=f,this.frameSpeed=g,this.ctx=h,this.animationSequence=[],this.currentFrame=0,this.counter=0,this.fpr=Math.floor(game.images[this.image].width/this.frameWidth),this.offCanvas=document.createElement("canvas"),this.offCanvas.width=game.images[this.image].width,this.offCanvas.height=game.images[this.image].height,this.offCtx=this.offCanvas.getContext("2d"),this.offCtx.drawImage(game.images[this.image],0,0,this.offCanvas.width,this.offCanvas.height),this.draw=function(a,b){for(this.FrameNum=this.startFrame;this.FrameNum<=this.endFrame;this.FrameNum++)this.animationSequence.push(this.FrameNum);this.counter==this.frameSpeed-1&&(this.currentFrame=(this.currentFrame+1)%this.animationSequence.length),this.counter=(this.counter+1)%this.frameSpeed,this.spriteRow=Math.floor(this.animationSequence[this.currentFrame]/this.fpr),this.spriteCol=Math.floor(this.animationSequence[this.currentFrame]%this.fpr),this.ctx.drawImage(this.offCanvas,this.spriteCol*this.frameWidth,this.spriteRow*this.frameHeight,this.frameWidth,this.frameHeight,a,b,this.imageSize,this.imageSize)}}function background(){this.element=document.getElementById("levelBackground"),this.elementStyle=window.getComputedStyle(this.element),this.elementTop=-parseInt(this.elementStyle.getPropertyValue("top")),this.elementYpos=1,this.speed=4,this.update=function(){this.elementYpos<=this.elementTop?(this.elementYpos+=this.speed,this.element.style.transform="translate3d(0,"+this.elementYpos+"px, 0)"):this.elementYpos=1},this.load=function(){for(var a=1;3>=a;a++)this.element.classList.remove("level"+a);this.element.classList.add("level"+game.level),this.elementTop=-parseInt(this.elementStyle.getPropertyValue("top"))}}function explosion(a,b,c,d,e,f){particle.call(this,a,b,c,d),this.x=Math.round(a-.2*e),this.y=Math.round(b-.2*e),this.speed=c,this.size=Math.round(1.5*e),this.hitTimer=0,this.dead=!1,this.deadTime=60,this.image="explosion.png",this.target=f,this.audioHit1="hit"+fileFormat,this.audioHit2="hit2"+fileFormat,this.audioHit3="hit3"+fileFormat,this.audioDead1="explosion"+fileFormat,this.audioDead2="explosion2"+fileFormat,this.audioDead3="explosion3"+fileFormat,this.audioExplode="blast"+fileFormat,this.ctx=game.contextPlayer,this.sprite=new sprite(this.image,this.size,96,96,0,19,2,this.ctx),this.update=function(){this.vx=Math.cos(d)*this.speed*dt,this.vy=Math.sin(d)*this.speed*dt,this.x+=this.vx,this.y+=this.vy},this.draw=function(){this.sprite.draw(this.x,this.y)},this.load=function(){game.sound&&("chasis"==this.target?game.sfx[this.audioHit1].paused?game.sounds.push(game.sfx[this.audioHit1]):game.sfx[this.audioHit2].paused?game.sounds.push(game.sfx[this.audioHit2]):game.sfx[this.audioHit3].paused&&game.sounds.push(game.sfx[this.audioHit3]):"enemy"==this.target?game.sfx[this.audioDead1].paused?game.sounds.push(game.sfx[this.audioDead1]):game.sfx[this.audioDead2].paused?game.sounds.push(game.sfx[this.audioDead2]):game.sfx[this.audioDead3].paused&&game.sounds.push(game.sfx[this.audioDead3]):("player"==this.target||"boss"==this.target)&&game.sounds.push(game.sfx[this.audioExplode]))},this.load()}function player(a,b){this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.speed=0,this.maxSpeed=400,this.size=Math.round(100/pixelRatio),this.hull=a,this.maxHull=a,this.bulletspeed=Math.round(X_BulletSpeed*game.height/1e3),this.imageO=game.images["fighter.png"],this.imageL1=game.images["fighter_left1.png"],this.imageL2=game.images["fighter_left2.png"],this.imageL3=game.images["fighter_left3.png"],this.imageL4=game.images["fighter_left4.png"],this.imageL5=game.images["fighter_left5.png"],this.imageR1=game.images["fighter_right1.png"],this.imageR2=game.images["fighter_right2.png"],this.imageR3=game.images["fighter_right3.png"],this.imageR4=game.images["fighter_right4.png"],this.imageR5=game.images["fighter_right5.png"],this.audioFire1="laser"+fileFormat,this.audioFire2="laser2"+fileFormat,this.audioFire3="laser3"+fileFormat,this.rendered=!1,this.hit=!1,this.hitTimer=0,this.imune=!1,this.imuneTimer=0,this.dead=!1,this.deadTimer=0,this.bulletTimer=1,this.bulletDivision=b,this.laserLevel=1,this.missileLevel=0,this.lives=X_Lives,this.ctx=game.contextPlayer,this.speedX=0,this.speedY=0,this.limitX1=Math.round(.5*-this.size),this.limitX2=Math.round(game.width-.5*this.size),this.limitY1=Math.round(.5*-this.size),this.limitY2=Math.round(game.height-.5*this.size),this.movement=Math.round(.007*game.height),this.canVibrate="vibrate"in navigator||"mozVibrate"in navigator,!this.canVibrate||"vibrate"in navigator||(navigator.vibrate=navigator.mozVibrate),this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.size,this.offCanvas.height=this.size,this.offCtx=this.offCanvas.getContext("2d"),this.offCtx.drawImage(this.imageO,0,0,this.offCanvas.width,this.offCanvas.height),this.image=this.offCanvas,this.playerImage=this.image,this.offCanvasL1=document.createElement("canvas"),this.offCanvasL1.width=this.size,this.offCanvasL1.height=this.size,this.offCtxL1=this.offCanvasL1.getContext("2d"),this.offCtxL1.drawImage(this.imageL1,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasL2=document.createElement("canvas"),this.offCanvasL2.width=this.size,this.offCanvasL2.height=this.size,this.offCtxL2=this.offCanvasL2.getContext("2d"),this.offCtxL2.drawImage(this.imageL2,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasL3=document.createElement("canvas"),this.offCanvasL3.width=this.size,this.offCanvasL3.height=this.size,this.offCtxL3=this.offCanvasL3.getContext("2d"),this.offCtxL3.drawImage(this.imageL3,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasL4=document.createElement("canvas"),this.offCanvasL4.width=this.size,this.offCanvasL4.height=this.size,this.offCtxL4=this.offCanvasL4.getContext("2d"),this.offCtxL4.drawImage(this.imageL4,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasL5=document.createElement("canvas"),this.offCanvasL5.width=this.size,this.offCanvasL5.height=this.size,this.offCtxL5=this.offCanvasL5.getContext("2d"),this.offCtxL5.drawImage(this.imageL5,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasR1=document.createElement("canvas"),this.offCanvasR1.width=this.size,this.offCanvasR1.height=this.size,this.offCtxR1=this.offCanvasR1.getContext("2d"),this.offCtxR1.drawImage(this.imageR1,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasR2=document.createElement("canvas"),this.offCanvasR2.width=this.size,this.offCanvasR2.height=this.size,this.offCtxR2=this.offCanvasR2.getContext("2d"),this.offCtxR2.drawImage(this.imageR2,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasR3=document.createElement("canvas"),this.offCanvasR3.width=this.size,this.offCanvasR3.height=this.size,this.offCtxR3=this.offCanvasR3.getContext("2d"),this.offCtxR3.drawImage(this.imageR3,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasR4=document.createElement("canvas"),this.offCanvasR4.width=this.size,this.offCanvasR4.height=this.size,this.offCtxR4=this.offCanvasR4.getContext("2d"),this.offCtxR4.drawImage(this.imageR4,0,0,this.offCanvas.width,this.offCanvas.height),this.offCanvasR5=document.createElement("canvas"),this.offCanvasR5.width=this.size,this.offCanvasR5.height=this.size,this.offCtxR5=this.offCanvasR5.getContext("2d"),this.offCtxR5.drawImage(this.imageR5,0,0,this.offCanvas.width,this.offCanvas.height),this.update=function(){if(this.speed=0,this.playerImage=this.image,this.speedX=Math.round(.1*(touchInitX-inputAreaX)/pixelRatio),this.speedY=Math.round(.1*(touchInitY-inputAreaY)/pixelRatio),!mouseIsDown||game.levelComplete||game.paused||game.gameOver?(this.image=this.offCanvas,document.getElementById("gamearea").style.cursor="crosshair"):(game.isMobile||(document.getElementById("gamearea").style.cursor="none"),moveRight1=this.speedX<-2&&this.speedX>=-4?!0:!1,moveRight2=this.speedX<-4&&this.speedX>=-6?!0:!1,moveRight3=this.speedX<-6&&this.speedX>=-8?!0:!1,moveRight4=this.speedX<-8&&this.speedX>=-10?!0:!1,moveRight5=this.speedX<-10?!0:!1,moveLeft1=this.speedX>2&&this.speedX<=4?!0:!1,moveLeft2=this.speedX>4&&this.speedX<=6?!0:!1,moveLeft3=this.speedX>6&&this.speedX<=8?!0:!1,moveLeft4=this.speedX>8&&this.speedX<=10?!0:!1,moveLeft5=this.speedX>10?!0:!1,this.speedX=this.speedX<this.movement?this.speedX:this.movement,this.speedY=this.speedY<this.movement?this.speedY:this.movement,this.speedX=this.speedX>-this.movement?this.speedX:-this.movement,this.speedY=this.speedY>-this.movement?this.speedY:-this.movement,(0!==this.speedX||0!==this.speedY)&&(this.x>=this.limitX1&&this.x<=this.limitX2&&this.y>=this.limitY1&&this.y<=this.limitY2?(this.x=this.x-this.speedX,this.y=this.y-this.speedY):this.x<this.limitX1?this.x=this.limitX2:this.x>this.limitX2?this.x=this.limitX1:this.y<this.limitY1?this.y=this.limitY2:this.y>this.limitY2&&(this.y=this.limitY1)),this.speedX=0,this.speedY=0,moveRight1?this.image=this.offCanvasR1:moveRight2?this.image=this.offCanvasR2:moveRight3?this.image=this.offCanvasR3:moveRight4?this.image=this.offCanvasR4:moveRight5?this.image=this.offCanvasR5:moveLeft1?this.image=this.offCanvasL1:moveLeft2?this.image=this.offCanvasL2:moveLeft3?this.image=this.offCanvasL3:moveLeft4?this.image=this.offCanvasL4:moveLeft5&&(this.image=this.offCanvasL5),this.rendered=!1),game.isMobile||((game.keys[37]||game.keys[65]&&!game.gameOver)&&this.x>0&&(this.speed=this.maxSpeed,this.image=this.offCanvasL5,this.rendered=!1,this.x-=Math.round(this.speed*dt)),(game.keys[39]||game.keys[68]&&!game.gameOver)&&this.x<=game.width-this.size&&(this.speed=this.maxSpeed,this.image=this.offCanvasR5,this.rendered=!1,this.x+=Math.round(this.speed*dt)),!game.keys[38]&&!game.keys[87]||game.gameOver||this.y>0&&(this.speed=this.maxSpeed,this.rendered=!1,this.y-=Math.round(this.speed*dt)),(game.keys[40]||game.keys[83]&&!game.gameOver)&&this.y<=game.height-this.size&&(this.speed=this.maxSpeed,this.rendered=!1,this.y+=Math.round(this.speed*dt))),game.levelComplete&&(this.speed=2*this.maxSpeed,this.rendered=!1,this.y-=Math.round(this.speed*dt)),this.midLaserX=Math.round(this.x+.5*this.size),this.leftlaserX=Math.round(this.x+.25*this.size),this.rightlaserX=Math.round(this.x+.75*this.size),this.LaserY=Math.round(this.y-.2*this.size),this.midMissileX=Math.round(this.x+.5*this.size),this.leftMissileX=this.x,this.rightMissileX=this.x+this.size,this.missileY=this.y+this.size,!game.keys[32]&&!mouseIsDown||this.dead||game.gameOver)this.bulletTimer=1;else if(this.bulletTimer++,this.bulletTimer%this.bulletDivision===0){switch(this.laserLevel){case 1:game.playerBullets.push(new playerBullet(this.midLaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]));break;case 2:game.playerBullets.push(new playerBullet(this.leftlaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.playerBullets.push(new playerBullet(this.rightlaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]));break;default:game.playerBullets.push(new playerBullet(this.leftlaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.playerBullets.push(new playerBullet(this.midLaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.playerBullets.push(new playerBullet(this.rightlaserX,this.LaserY,600,-Math.PI/2,45,1,1,"laser.png",48,11)),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]))}switch(this.missileLevel){case 0:break;case 1:game.playerBullets.push(new playerBullet(this.midMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2));break;case 2:game.playerBullets.push(new playerBullet(this.leftMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2)),game.playerBullets.push(new playerBullet(this.rightMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2));break;default:game.playerBullets.push(new playerBullet(this.leftMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2)),game.playerBullets.push(new playerBullet(this.rightMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2)),game.playerBullets.push(new playerBullet(this.midMissileX,this.missileY,100,-Math.PI/2,45,2,1.03,"p_missile.png",64,2))}}this.hull<=0&&!this.dead&&(this.dead=!0,this.lives-=1,game.explosions.push(new explosion(this.x,this.y,0,0,this.size,"player")),gameUI.updateHangar()),this.dead&&this.deadTimer<=100&&(this.deadTimer++,this.deadTimer>100&&this.lives>0?(mouseIsDown=0,this.hull=a,this.dead=!1,this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.image=this.offCanvas,this.rendered=!1,this.hit=!1,this.hitTimer=0,this.friction=0,this.laserLevel=1,this.missileLevel=0,gameUI.updateEnergy(),this.deadTimer=0,this.imune=!0,this.imuneTimer=0):this.deadTimer>100&&0===this.lives&&!game.gameOver?(mouseIsDown=0,game.keys[13]=!1,this.deadTimer=0,game.gameOver=!0,gameState.gameOver()):(this.x=Math.round(.5*game.width),this.y=Math.round(1.5*game.height))),this.imune&&(this.imuneTimer++,this.imuneTimer>250&&(this.imune=!1,this.imuneTimer=0))},this.draw=function(){this.dead||(this.imune&&!game.faded&&game.started&&!game.levelComplete&&(this.ctx.globalAlpha=.8,(this.imuneTimer>=0&&this.imuneTimer<15||this.imuneTimer>=20&&this.imuneTimer<35||this.imuneTimer>=40&&this.imuneTimer<55||this.imuneTimer>=70&&this.imuneTimer<75||this.imuneTimer>=90&&this.imuneTimer<95||this.imuneTimer>=110&&this.imuneTimer<115||this.imuneTimer>=130&&this.imuneTimer<135||this.imuneTimer>=150&&this.imuneTimer<155||this.imuneTimer>=160&&this.imuneTimer<175||this.imuneTimer>180)&&this.ctx.drawImage(this.playerImage,this.x,this.y)),this.imune||(this.ctx.globalAlpha<1&&!game.faded&&!game.levelComplete&&(this.ctx.globalAlpha+=.1),this.ctx.drawImage(this.playerImage,this.x,this.y)),this.hit&&!this.imune&&(this.canVibrate&&navigator.vibrate(30),this.hit=!1))},this.load=function(){this.update(),this.draw()},this.reset=function(){game.gameOver=!1,this.dead=!1,this.deadTimer=0,this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.image=this.offCanvas,this.hull=a,this.rendered=!1,this.hit=!1,this.hitTimer=0,this.friction=0,this.laserLevel=1,this.missileLevel=0,this.lives=X_Lives}}function playerBullet(a,b,c,d,e,f,g,h,i,j){particle.call(this,a,b,c,d),this.size=Math.round(e/pixelRatio),this.x=Math.round(a-.5*this.size),this.y=Math.round(b-.5*this.size),this.power=f,this.image=h,this.dead=!1,this.deadTime=60,this.friction=g,this.dtSet=!1,this.ctx=game.contextEnemies,this.sprite=new sprite(this.image,this.size,i,i,0,j,4,this.ctx),this.update=function(){0===dt||this.dtSet||(this.vx=Math.cos(d)*(c/pixelRatio)*dt,this.vy=Math.sin(d)*(c/pixelRatio)*dt,this.dtSet=!0),this.vx*=this.friction,this.vy*=this.friction,this.x+=this.vx,this.y+=this.vy},this.draw=function(){this.dead||this.sprite.draw(this.x,this.y)}}function enemy(a,b,c,d,e,f,g,h,i){switch(particle.call(this,a,b,c,d),this.type=f,this.type){case"pawn":this.size=Math.round(65/pixelRatio);break;case"miniboss":this.size=Math.round(120/pixelRatio);break;case"base":this.size=Math.round(170/pixelRatio),this.rotation=0}this.spritePos=Math.round(.5*this.size),this.hull=e,this.image=game.images[g],this.hitTimer=0,this.dead=!1,this.bulletTimer=1,this.sheep=i||!1,this.fireRate=60*h,this.bulletDivision=this.sheep?2*this.fireRate-Math.floor(Math.random()*this.fireRate)||99999:this.bulletDivision=this.fireRate||99999,this.ctx=game.contextEnemies,this.speed=c/pixelRatio,this.direction=d,this.collided=!1,this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.size,this.offCanvas.height=this.size,this.offCtx=this.offCanvas.getContext("2d"),this.offCtx.drawImage(this.image,0,0,this.offCanvas.width,this.offCanvas.height),this.update=function(){this.vx=Math.cos(this.direction)*this.speed*dt,this.vy=Math.sin(this.direction)*this.speed*dt,this.x+=this.vx,this.y+=this.vy,this.spriteX=this.x+this.spritePos,this.spriteY=this.y+this.spritePos,this.hull<=0&&(this.dead=!0,game.explosions.push(new explosion(this.x,this.y,this.speed,this.direction,this.size,"enemy")),playerShip.crashed||(game.score++,game.levelScore++,gameUI.updateScore())),0!==this.fireRate&&(this.bulletTimer++,this.bulletTimer%this.bulletDivision==1&&(this.bulletTimer=1,bulletX=Math.round(this.x+.42*this.size),bulletY=Math.round(this.y+this.size),bulletDirection=this.angleTo(playerShip),game.enemyBullets.push(new enemyBullet(bulletX,bulletY,50,bulletDirection,1,"e_missile.png")))),"base"!=this.type&&(this.direction-=utils.randomRange(-.05,.05))},this.draw=function(){"base"==this.type?this.dead||(this.rotation+=.01,this.ctx.save(),this.ctx.translate(this.spriteX,this.spriteY),this.ctx.rotate(this.rotation),this.ctx.drawImage(this.offCanvas,-this.spritePos,-this.spritePos),this.ctx.restore()):this.dead||this.ctx.drawImage(this.offCanvas,this.x,this.y)}}function boss(a,b,c,d,e,f){particle.call(this,a,b,c,d),this.hull=e,this.image=game.images[f],this.size=Math.round(200/pixelRatio),this.hit=!1,this.audioHit1="hit"+fileFormat,this.audioHit2="hit2"+fileFormat,this.audioHit3="hit3"+fileFormat,this.hitTimer=0,this.dead=!1,this.deadTimer=0,this.bulletTimer1=1,this.bulletTimer2=1,this.bulletDivision1=50,this.bulletDivision2=30,this.fireRate=0,this.yStop=Math.round(.1*game.height),this.xBondary=Math.round(game.width-this.size/4),this.ctx=game.contextEnemies,this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.size,this.offCanvas.height=this.size,this.offCtx=this.offCanvas.getContext("2d"),this.offCtx.drawImage(this.image,0,0,this.offCanvas.width,this.offCanvas.height),this.update=function(){this.bulletDirection=this.angleTo(playerShip),this.vx=Math.cos(d)*(c/pixelRatio)*dt,this.vy=Math.sin(d)*(c/pixelRatio)*dt,this.x+=this.vx,this.y+=this.vy,this.hit&&this.hull>0&&(game.sound&&(game.sfx[this.audioHit1].paused?game.sounds.push(game.sfx[this.audioHit1]):game.sfx[this.audioHit2].paused?game.sounds.push(game.sfx[this.audioHit2]):game.sfx[this.audioHit3].paused&&game.sounds.push(game.sfx[this.audioHit3])),this.hit=!1),!Collision(playerShip,this)||this.dead||game.gameOver||(playerShip.hull-=this.hull,playerShip.hit=!0,this.hit=!0,this.hull-=playerShip.hull),this.hull<=0&&(game.explosions.push(new explosion(this.x,this.y,c,d,this.size,"boss")),playerShip.crashed||(game.score++,game.levelScore++,gameUI.updateScore(),game.bossDead=!0,this.dead=!0)),this.bulletTimer1++,this.bulletTimer2++,this.bulletTimer1%this.bulletDivision1==1&&(this.bulletTimer1=1,mBulletX1=Math.round(this.x),mBulletX2=Math.round(this.x+this.size),mBulletY=Math.round(this.y+.6*this.size),game.enemyBullets.push(new enemyBullet(mBulletX1,mBulletY,50,this.bulletDirection,1,"e_missile.png")),game.enemyBullets.push(new enemyBullet(mBulletX2,mBulletY,50,this.bulletDirection,1,"e_missile.png"))),this.bulletTimer2%this.bulletDivision2==1&&(this.bulletTimer2=1,lBulletX=Math.round(this.x+.48*this.size),lBulletY=Math.round(this.y+this.size),game.enemyBullets.push(new enemyBullet(lBulletX,lBulletY,250,Math.PI/2,1.5,"laser.png")),game.enemyBullets.push(new enemyBullet(lBulletX,lBulletY,250,Math.PI/2,1.5,"laser.png"))),this.y>this.yStop&&(c=0,this.x>0&&this.x<=this.xBondary&&(this.x<playerShip.x&&this.x<=this.xBondary-1?this.x+=1:this.x>playerShip.x&&this.x>1&&(this.x-=1)))},this.draw=function(){this.dead||this.ctx.drawImage(this.offCanvas,this.x,this.y)}}function enemyBullet(a,b,c,d,e,f){particle.call(this,a,b,c,d),this.size=Math.round(30/pixelRatio),this.spriteX=-Math.round(.5*this.size),this.spriteY=-Math.round(.5*this.size),this.power=e,this.image=f,this.dead=!1,this.deadTime=60,this.friction=1.02,this.dtSet=!1,this.ctx=game.contextEnemies,this.sprite=new sprite(this.image,this.size,64,64,0,2,5,this.ctx),this.update=function(){0===dt||this.dtSet||(this.vx=Math.cos(d)*(c/pixelRatio)*dt,this.vy=Math.sin(d)*(c/pixelRatio)*dt,this.dtSet=!0),this.vx*=this.friction,this.vy*=this.friction,this.x+=this.vx,this.y+=this.vy},this.draw=function(){this.dead||(this.ctx.save(),this.ctx.translate(this.x,this.y),this.ctx.rotate(d-Math.PI/2),this.sprite.draw(this.spriteX,this.spriteY),this.ctx.restore())}}function loot(a,b){particle.call(this,a,b),this.speed=Math.round(250/pixelRatio),this.direction=Math.PI/2,this.size=Math.round(45/pixelRatio),this.dead=!1,this.drops=["health","laser","missile"];var c=Math.floor(Math.random()*this.drops.length);switch(this.type=this.drops[c],this.type){case"health":this.image=game.images["fighter.png"];break;case"laser":this.image=game.images["laser.png"];break;case"missile":this.image=game.images["p_missile.png"]}this.sfx1="loot_powerUp"+fileFormat,this.sfx2="loot_powerUp2"+fileFormat,this.sfx3="loot_powerUp3"+fileFormat,this.ctx=game.contextPlayer,this.offCanvas=document.createElement("canvas"),this.offCanvas.width=this.size,this.offCanvas.height=this.size,this.offCtx=this.offCanvas.getContext("2d"),this.offCtx.drawImage(this.image,0,0,this.offCanvas.width,this.offCanvas.height),this.update=function(){if(this.vx=Math.cos(this.direction)*this.speed*dt,this.vy=Math.sin(this.direction)*this.speed*dt,this.x+=this.vx,this.y+=this.vy,Collision(this,playerShip)&&!this.dead&&!game.gameOver){switch(this.type){case"health":this.hull<=7.5?playerShip.hull+=2.5:playerShip.hull=10,gameUI.updateEnergy();break;case"laser":playerShip.laserLevel+=1;break;case"missile":playerShip.missileLevel+=1}game.sound&&(game.sfx[this.sfx1].paused?game.sounds.push(game.sfx[this.sfx1]):game.sfx[this.sfx2].paused?game.sounds.push(game.sfx[this.sfx2]):game.sfx[this.sfx3].paused&&game.sounds.push(game.sfx[this.sfx3])),this.dead=!0}},this.draw=function(){this.dead||this.ctx.drawImage(this.offCanvas,this.x,this.y)}}function ui(){var a=$("#ui"),b=document.getElementById("uiLevel"),c=document.getElementById("uiScore"),d=document.getElementById("uiEBar"),e=document.getElementById("uiHangarList"),f=800;this.updateLevel=function(){b.innerHTML="STAGE "+game.level},this.updateScore=function(){c.innerHTML="SCORE: "+game.score},this.updateEnergy=function(){shipEnergy=playerShip.hull/playerShip.maxHull*100,shipEnergy<0&&(shipEnergy=0),shipEnergyPC=shipEnergy+"%",shipEnergy>=66?(d.classList.remove("eBar-red"),d.classList.remove("eBar-yellow"),d.classList.add("eBar-blue")):shipEnergy>=33&&shipEnergy<66?(d.classList.remove("eBar-red"),d.classList.add("eBar-yellow"),d.classList.remove("eBar-blue")):(d.classList.add("eBar-red"),d.classList.remove("eBar-yellow"),d.classList.remove("eBar-blue")),d.style.width=shipEnergyPC},this.updateHangar=function(){switch(playerShip.lives){case 3:e.getElementsByTagName("li")[0].style.display="inline-block",e.getElementsByTagName("li")[1].style.display="inline-block",e.getElementsByTagName("li")[2].style.display="inline-block";break;case 2:e.getElementsByTagName("li")[0].style.display="none";break;case 1:e.getElementsByTagName("li")[1].style.display="none";break;case 0:e.getElementsByTagName("li")[2].style.display="none"}},this.fade=function(b){switch(b){case"in":a.fadeIn(f);break;case"out":a.fadeOut(f)}},this.updateAll=function(){this.updateLevel(),this.updateScore(),this.updateEnergy(),this.updateHangar()}}function lights(){this.fader=$("#fader");var a=2e3;this["switch"]=function(a){switch(a){case"on":this.fader.hide(),game.faded=!1;break;case"off":this.fader.show(),game.faded=!0}},this.fade=function(b){switch(b){case"in":game.fadingIn=!0,this.fader.fadeOut(a,function(){game.fadingIn=!1,game.faded=!1});break;case"out":game.fadingOut=!0,this.fader.fadeIn(a,function(){game.fadingOut=!1,game.faded=!0})}}}function text(a,b,c){var d=$("#h1"),e=$("#h2"),f=$("#h3"),g=a,h=b,i=game.isMobile?"Tap screen to continue":"Press ENTER or LMB to continue",j=$(".all-text"),k=c,l=2e3;this["switch"]=function(a){switch(a){case"on":j.show(),game.textFaded=!1;break;case"off":j.stop(!0,!0),j.hide(),game.textFaded=!0}},this.fade=function(a){switch(a){case"in":game.textFadingIn=!0,j.fadeIn(l,function(){game.textFadingIn=!1,game.textFaded=!1});break;case"out":game.textFadingOut=!0,j.fadeOut(l,function(){d.text(""),e.text(""),f.text(""),game.textFadingOut=!1,game.textFaded=!0})}},this.init=function(){d.text(g),e.text(h),f.text(k?i:"")},this.init()}function state(){this.start=function(){gameState.pause(),gameLights["switch"]("off"),removeGamePlayInput(),addStandByInput(),gameMenu.toggled&&gameMenu.toggle(),game.started?(game.score=0,game.level=1):game.started=!0,introBriefing=["Outside the galaxy","The outer space","AlphaPI 2034"],introText=new text("Stage "+game.level,introBriefing[game.level-1],!0),$(".menu-option-btn").promise().done(function(){$("#menuBackground").promise().done(function(){gameBackground.load(),introText.fade("in"),$(".all-text").promise().done(function(){removeStandByInput(),game.textFaded?(game.loaded||startGame(),addGamePlayInput(),resetGame(),gameLights.fade("in"),gameState.unPause()):$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),introText.fade("out"),$(".all-text").promise().done(function(){game.loaded||startGame(),addGamePlayInput(),resetGame(),gameLights.fade("in"),gameState.unPause()})})})})})},this.lvlComplete=function(){game.started=!1,removeGamePlayInput(),gameUI.fade("out"),levelUpText=new text("Stage Complete!",game.score+" enemy ships destroyed",!0),levelUpText["switch"]("on"),$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),levelUpText.fade("out"),$(".all-text").promise().done(function(){gameUI.fade("out"),gameLights.fade("out"),$("#fader").promise().done(function(){gameState.pause(),game.level++,gameState.start()})})})},this.gameOver=function(){game.started=!1,removeGamePlayInput(),gameUI.fade("out"),gameOverText=new text("Game Over",game.score+" enemy ships destroyed",!0),gameOverText["switch"]("on"),$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),gameOverText.fade("out"),$(".all-text").promise().done(function(){gameUI.fade("out"),gameLights.fade("out"),$("#fader").promise().done(function(){gameState.pause(),game.score=0,game.level=1,gameLights.fade("out"),gameMenu.toggle()})})})},this.pause=function(){game.paused=!0,gameUI.fade("out")},this.unPause=function(){game.paused=!1,gameUI.updateAll(),gameUI.fade("in")}}function menu(){function a(){game.fullScreen=game.fullScreen?!1:!0,game.fullScreen?(g.addClass("active"),g.text("Fullscreen: ON")):(g.removeClass("active"),g.text("Fullscreen: OFF"))}var b=$("#menuBackground"),c=$("#resumeGame"),d=$("#startGame"),e=$("#toggleSound"),f=$("#toggleMusic"),g=$("#toggleFullScreen"),h=$("#credits"),i=$(".menu-option-btn"),j=800;this.toggled=!1,document.addEventListener("fullscreenchange",a),document.addEventListener("webkitfullscreenchange",a),document.addEventListener("mozfullscreenchange",a),document.addEventListener("MSFullscreenChange",a),this.toggleFullScreen=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},this.toggleSound=function(){game.sound=game.sound?!1:!0,localStorage.prawnsSound=game.sound,game.sound?(e.addClass("active"),e.text("Sound: ON")):(e.removeClass("active"),e.text("Sound: OFF"))},this.toggleMusic=function(){if(game.music=game.music?!1:!0,localStorage.prawnsMusic=game.music,game.started&&game.tracks.length>0){for(var a in game.tracks)game.tracks[a].pause();game.tracks=[]}else if(game.started&&game.tracks.length<1){game.tracks.push(game.soundTracks["tune1"+fileFormat]);for(var b in game.tracks)game.tracks[b].play(),game.tracks[b].loop=!0}game.music?(f.addClass("active"),f.text("Music: ON")):(f.removeClass("active"),f.text("Music: OFF"))},this.toggle=function(){this.toggled=this.toggled?!1:!0,this.toggled?(gameState.pause(),i.css({display:"block"}),b.fadeIn(j),b.promise().done(function(){game.started?("Restart"!==d.text&&d.text("Restart"),c.animate({opacity:1,right:"-=50%"},800)):d.text("Start"),d.animate({opacity:1,left:"-=50%"},800),e.animate({opacity:1,right:"-=50%"},800),f.animate({opacity:1,left:"-=50%"},800),g.animate({opacity:1,right:"-=50%"},800),h.animate({opacity:1,left:"-=50%"},800)})):(game.started&&c.animate({opacity:0,right:"+=50%"},800),d.animate({opacity:0,left:"+=50%"},800),e.animate({opacity:0,right:"+=50%"},800),f.animate({opacity:0,left:"+=50%"},800),g.animate({opacity:0,right:"+=50%"},800),h.animate({opacity:0,left:"+=50%"},800),i.promise().done(function(){b.fadeOut(j),b.promise().done(function(){game.loaded&&!game.faded&&gameState.unPause()})}))},this.init=function(){"true"===localStorage.prawnsSound?(e.addClass("active"),e.text("Sound: ON")):(e.removeClass("active"),e.text("Sound: OFF")),"true"===localStorage.prawnsMusic?(f.addClass("active"),f.text("Music: ON")):(f.removeClass("active"),f.text("Music: OFF")),"true"===localStorage.fullScreen?(g.addClass("active"),g.text("Fullscreen: ON")):(g.removeClass("active"),g.text("Fullscreen: OFF")),gameMenu.toggle()}}function update(){if(clrCanvas(),gameBackground.update(),dtTimer<=100){var a=(new Date).getTime(),b=a-timeThen;if(dtArray.push(b),timeThen=a,dtTimer++,100==dtTimer){for(var c=0,d=0;d<dtArray.length-10;d++)c+=dtArray[d+10];dt=Math.round(c/dtArray.length)/1e3}}if(game.timer++,game.seconds=game.timer/60||0,playerShip.load(),game.seconds==Math.round(game.seconds)&&"undefined"!=typeof window["level"+game.level]["second"+game.seconds]&&window["level"+game.level]["second"+game.seconds](),window["level"+game.level].update(),game.bossDead&&game.levelUpTimer<=100&&(game.levelUpTimer++,100==game.levelUpTimer&&(game.levelComplete=!0,gameState.lvlComplete(),mouseIsDown=0)),game.playerBullets.length>=1){for(var e in game.playerBullets)game.playerBullets[e].dead||(game.playerBullets[e].update(),game.playerBullets[e].draw());for(var f in game.playerBullets)(game.playerBullets[f].dead||game.playerBullets[f].x>game.outerRight||game.playerBullets[f].x<game.outerLeft||game.playerBullets[f].y>game.outerBottom||game.playerBullets[f].y<game.outerTop)&&(game.playerBullets[f]=null,game.playerBullets.splice(f,1))}if(game.enemies.length>0){for(var g in game.enemies)game.enemies[g].update(),game.enemies[g].draw();if(game.playerBullets.length>=1)for(var h in game.enemies)for(var i in game.playerBullets)Collision(game.enemies[h],game.playerBullets[i])&&!game.enemies[h].dead&&(game.enemies[h].hit=!0,game.enemies[h].hull-=game.playerBullets[i].power,game.enemies[h].hull>0&&game.explosions.push(new explosion(game.enemies[h].x+.5*game.enemies[h].size,game.enemies[h].y+.5*game.enemies[h].size,0,1,.25*game.enemies[h].size,"chasis")),game.playerBullets[i].dead=!0);
for(var j in game.enemies)!Collision(game.enemies[j],playerShip)||game.enemies[j].dead||playerShip.imune||game.gameOver||(playerShip.hull-=game.enemies[j].hull,gameUI.updateEnergy(),playerShip.hit=!0,game.enemies[j].hit=!0,game.enemies[j].hull-=playerShip.hull);for(var k in game.enemies)(game.enemies[k].dead||game.enemies[k].x>game.outerRight||game.enemies[k].x<game.outerLeft||game.enemies[k].y>game.outerBottom||game.enemies[k].y<game.outerTop)&&(game.enemies[k].dead&&(lootchance=Math.random(),lootchance<.3&&game.loot.push(new loot(game.enemies[k].x,game.enemies[k].y))),game.enemies[k]=null,game.enemies.splice(k,1))}if(game.waves.length>0)for(var l in game.waves)game.waves[l].update(),game.waves[l].over&&(game.waves[l]=null,game.waves.splice(l,1));if(game.loot.length>=1){for(var m in game.loot)game.loot[m].update(),game.loot[m].draw();for(var n in game.loot)(game.loot[n].dead||game.loot[n].x>game.width+game.loot[n].size||game.loot[n].x<0-game.loot[n].size||game.loot[n].y>game.height+game.loot[n].size||game.loot[n].y<-30)&&(game.loot[n]=null,game.loot.splice(n,1))}if(game.enemyBullets.length>=1){for(var o in game.enemyBullets)game.enemyBullets[o].update(),game.enemyBullets[o].draw();for(var p in game.enemyBullets)!Collision(game.enemyBullets[p],playerShip)||playerShip.imune||game.gameOver||(playerShip.hull-=game.enemyBullets[p].power,gameUI.updateEnergy(),playerShip.hit=!0,game.enemyBullets[p].dead=!0);for(var q in game.enemyBullets)(game.enemyBullets[q].dead||game.enemyBullets[q].x>game.width+game.enemyBullets[q].size||game.enemyBullets[q].x<0-game.enemyBullets[q].size||game.enemyBullets[q].y>game.height+game.enemyBullets[q].size||game.enemyBullets[q].y<-30)&&(game.enemyBullets[q]=null,game.enemyBullets.splice(q,1))}if(game.explosions.length>0){for(var r in game.explosions)game.explosions[r].update(),game.explosions[r].draw();for(var s in game.explosions)game.explosions[s].sprite.currentFrame>=game.explosions[s].sprite.endFrame&&(game.explosions[s]=null,game.explosions.splice(s,1))}if(game.sounds.length>0)for(var t in game.sounds)game.sounds[t].play(),game.sounds[t].addEventListener("paused",game.sounds.splice(t,1))}function respondCanvas(){game.paused=gameMenu.toggled?game.paused:!0,setGameDimensions(),"undefined"!=typeof window[playerShip]&&(playerShip.bulletspeed=Math.round(X_BulletSpeed*game.height/1e3),playerShip.limitX2=Math.round(game.width-.5*playerShip.size),playerShip.limitY2=Math.round(game.height-.5*playerShip.size),playerShip.movement=Math.round(.007*game.height)),game.started||"undefined"==typeof window[playerShip]||(playerShip.x=Math.round(.46*game.width),playerShip.y=Math.round(.9*game.height)),game.paused=gameMenu.toggled?game.paused:!1}function addGamePlayInput(){inputAreaX=playerShip.x,inputAreaY=playerShip.y,inputArea.addEventListener("mousedown",mouseDown,!1),inputArea.addEventListener("mouseup",mouseUp,!1),inputArea.addEventListener("mousemove",mouseXY,!1),inputArea.addEventListener("touchstart",touchDown,!1),inputArea.addEventListener("touchend",touchUp,!1),inputArea.addEventListener("touchcancel",touchUp,!1),inputArea.addEventListener("touchleave",touchUp,!1),inputArea.addEventListener("touchmove",touchXY,!1)}function addStandByInput(){inputArea.addEventListener("mouseup",standByInput,!1),inputArea.addEventListener("touchstart",standByInput,!1)}function removeGamePlayInput(){inputArea.removeEventListener("mousedown",mouseDown,!1),inputArea.removeEventListener("mouseup",mouseUp,!1),inputArea.removeEventListener("mousemove",mouseXY,!1),inputArea.removeEventListener("touchstart",touchDown,!1),inputArea.removeEventListener("touchend",touchUp,!1),inputArea.removeEventListener("touchcancel",touchUp,!1),inputArea.removeEventListener("touchleave",touchUp,!1),inputArea.removeEventListener("touchmove",touchXY,!1)}function removeStandByInput(){inputArea.removeEventListener("mouseup",standByInput,!1),inputArea.removeEventListener("touchstart",standByInput,!1)}function mouseUp(a){a.preventDefault(),mouseIsDown=0}function touchUp(a){a.preventDefault(),mouseIsDown=0}function mouseDown(a){a.preventDefault(),mouseIsDown=1,touchInitX=a.pageX-inputArea.offsetLeft,touchInitY=a.pageY-inputArea.offsetTop}function touchDown(a){a.preventDefault(),mouseIsDown=1;var b=a.targetTouches[0];touchInitX=b.pageX-b.target.offsetLeft,touchInitY=b.pageY-b.target.offsetTop}function mouseXY(a){a.preventDefault(),inputAreaX=a.pageX-inputArea.offsetLeft,inputAreaY=a.pageY-inputArea.offsetTop}function touchXY(a){a.preventDefault();var b=a.targetTouches[0];inputAreaX=b.pageX-inputArea.offsetLeft,inputAreaY=b.pageY-inputArea.offsetTop}function standByInput(a){a.preventDefault(),game.fadingIn&&(gameLights.fader.stop(!0,!0),gameLights["switch"]("on")),game.fadingOut&&(gameLights.fader.stop(!0,!0),gameLights["switch"]("off")),game.textFadingIn&&($(".all-text").stop(!0,!0),gameText["switch"]("off")),game.textFadingOut&&($(".all-text").stop(!0,!0),gameText["switch"]("off"))}function clrCanvas(){game.contextPlayer.clearRect(0,0,game.width,game.height),game.contextEnemies.clearRect(0,0,game.width,game.height)}function resetGame(){mouseIsDown=0,gameLights["switch"]("off"),clrCanvas(),game.bossDead=!1,game.levelComplete=!1,game.timer=0,game.levelUpTimer=0,playerShip.reset(),game.playerBullets=[],game.enemyBullets=[],game.explosions=[],game.enemies=[],game.waves=[],game.loot=[],gameUI.updateAll(),game.sounds=[];for(var a in game.tracks)game.tracks[a].pause();game.tracks=[],game.music&&game.tracks.length<1&&(game.tracks.push(game.soundTracks["tune1"+fileFormat]),game.tracks[0].play(),game.tracks[0].loop=!0)}function Collision(a,b){return!(a.x>b.x+b.size||a.x+a.size<b.x||a.y>b.y+b.size||a.y+a.size<b.y)}function loop(){requestAnimFrame(loop),game.paused||update()}function startGame(){game.loaded=!0,"undefined"==typeof window[playerShip]&&(playerShip=new player(10,15)),game.tracks.push(game.soundTracks["tune1"+fileFormat]),game.tracks.push(game.soundTracks["tune2"+fileFormat]),game.tracks.push(game.soundTracks["boss"+fileFormat]),game.tracks.push(game.soundTracks["victory"+fileFormat]);for(var a in game.tracks)game.tracks[a].play(),game.tracks[a].pause();game.tracks=[],game.sounds.push(game.sfx["laser"+fileFormat]),game.sounds.push(game.sfx["laser2"+fileFormat]),game.sounds.push(game.sfx["laser3"+fileFormat]),game.sounds.push(game.sfx["hit"+fileFormat]),game.sounds.push(game.sfx["hit2"+fileFormat]),game.sounds.push(game.sfx["hit3"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp2"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp3"+fileFormat]),game.sounds.push(game.sfx["explosion"+fileFormat]),game.sounds.push(game.sfx["explosion2"+fileFormat]),game.sounds.push(game.sfx["explosion3"+fileFormat]),game.sounds.push(game.sfx["blast"+fileFormat]);for(var b in game.sounds)game.sounds[b].play(),game.sounds[b].pause();game.sounds=[],loop()}function initImages(a){game.requiredImages=a.length;for(var b in a){var c=new Image;c.src=a[b];var d=c.src.split("/").pop();game.images[d]=c,game.images[d].onload=function(){game.doneImages++}}}function sfxEventHandler(a){this.sfx=a,this.sfx.removeEventListener("canplaythrough",sfxEventHandler,!1),game.doneSfx++}function stEventHandler(a){this.st=a,this.st.removeEventListener("canplaythrough",stEventHandler,!1),game.doneSoundTracks++}function initSfx(a){game.requiredSfx=a.length;for(var b in a){var c=new Audio;c.src=a[b];var d,e=c.src.split("/").pop();e in game.sfx?(d++,e=c.src.match(/([^\/]+)(?=\.\w+$)/)[0]+d+fileFormat,game.sfx[e]=c):(d=1,game.sfx[e]=c),console.log(audiopreload),audiopreload?(game.sfx[e].preload="auto",game.sfx[e].addEventListener("canplaythrough",sfxEventHandler.bind(window,this),!1)):game.doneSfx++}}function initSoundTracks(a){game.requiredSoundTracks=a.length;for(var b in a){var c=new Audio;c.src=a[b];var d=c.src.split("/").pop();game.soundTracks[d]=c,audiopreload?(game.soundTracks[d].preload="auto",game.soundTracks[d].addEventListener("canplaythrough",stEventHandler.bind(window,this,!1))):game.doneSoundTracks++}}function checkImages(){game.doneImages>=game.requiredImages?(loadingText=new text("Loading Sfx.. ","",!1),loadingBarFiller.css({width:"0"}),initSfx(["_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/blast"+fileFormat]),checkSfx()):(loadingBarWidth=game.doneImages/game.requiredImages*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkImages()},1))}function checkSfx(){game.doneSfx>=game.requiredSfx?(loadingText=new text("Loading Sound Tracks.. ","",!1),loadingBarFiller.css({width:"0"}),initSoundTracks(["_sounds/_soundTracks/_lvl1/tune1"+fileFormat,"_sounds/_soundTracks/_lvl1/tune2"+fileFormat,"_sounds/_soundTracks/_lvl1/victory"+fileFormat,"_sounds/_soundTracks/_lvl1/boss"+fileFormat]),checkSoundTracks()):(loadingBarWidth=game.doneSfx/game.requiredSfx*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkSfx()},1))}function checkSoundTracks(){game.doneSoundTracks>=game.requiredSoundTracks?(loadingText["switch"]("off"),loadingBar.hide(),gameMenu.init()):(loadingBarWidth=game.doneSoundTracks/game.requiredSoundTracks*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkSoundTracks()},1))}function toggleSound(){game.sound=game.sound?!1:!0,localStorage.prawnsSound=game.sound}function toggleMusic(){if(game.music=game.music?!1:!0,localStorage.prawnsMusic=game.music,game.tracks.length>0){for(var a in game.tracks)game.tracks[a].pause();game.tracks=[]}else if(game.tracks.length<1){game.tracks.push(game.soundTracks["tune1"+fileFormat]);for(var b in game.tracks)game.tracks[b].play(),game.tracks[b].loop=!0}}function testpreload(a){clearTimeout(timeout),audioTest.removeEventListener("loadeddata",testpreload),audiopreload=void 0!==a&&"loadeddata"===a.type?!0:!1,checkImages()}var vector={_x:1,_y:0,create:function(a,b){var c=Object.create(this);return c.setX(a),c.setY(b),c},setX:function(a){this._x=a},getX:function(){return this._x},setY:function(a){this._y=a},getY:function(){return this._y},setAngle:function(a){var b=this.getLength();this._x=Math.cos(a)*b,this._y=Math.sin(a)*b},getAngle:function(){return Math.atan2(this._y,this._x)},setLength:function(a){var b=this.getAngle();this._x=Math.cos(b)*a,this._y=Math.sin(b)*a},getLength:function(){return Math.sqrt(this._x*this._x+this._y*this._y)},add:function(a){return vector.create(this._x+a.getX(),this._y+a.getY())},subtract:function(a){return vector.create(this._x-a.getX(),this._y-a.getY())},multiply:function(a){return vector.create(this._x*a,this._y*a)},divide:function(a){return vector.create(this._x/a,this._y/a)},addTo:function(a){this._x+=a.getX(),this._y+=a.getY()},subtractFrom:function(a){this._x-=a.getX(),this._y-=a.getY()},multiplyBy:function(a){this._x*=a,this._y*=a},divideBy:function(a){this._x/=a,this._y/=a}},utils={norm:function(a,b,c){return(a-b)/(c-b)},lerp:function(a,b,c){return(c-b)*a+b},map:function(a,b,c,d,e){return utils.lerp(utils.norm(a,b,c),d,e)},clamp:function(a,b,c){return Math.min(Math.max(a,Math.min(b,c)),Math.max(b,c))},distance:function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)},distanceXY:function(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)},circleCollision:function(a,b){return utils.distance(a,b)<=a.radius+b.radius},circlePointCollision:function(a,b,c){return utils.distanceXY(a,b,c.x,c.y)<c.radius},pointInRect:function(a,b,c){return utils.inRange(a,c.x,c.x+c.width)&&utils.inRange(b,c.y,c.y+c.height)},inRange:function(a,b,c){return a>=Math.min(b,c)&&a<=Math.max(b,c)},rangeIntersect:function(a,b,c,d){return Math.max(a,b)>=Math.min(c,d)&&Math.min(a,b)<=Math.max(c,d)},rectIntersect:function(a,b){return utils.rangeIntersect(a.x,a.x+a.width,b.x,b.x+b.width)&&utils.rangeIntersect(a.y,a.y+a.height,b.y,b.y+b.height)},degreesToRads:function(a){return a/180*Math.PI},radsToDegrees:function(a){return 180*a/Math.PI},randomRange:function(a,b){return a+Math.random()*(b-a)},randomInt:function(a,b){return Math.floor(a+Math.random()*(b-a+1))},roundToPlaces:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},roundNearest:function(a,b){return Math.round(a/b)*b},quadraticBezier:function(a,b,c,d,e){return e=e||{},e.x=Math.pow(1-d,2)*a.x+2*(1-d)*d*b.x+d*d*c.x,e.y=Math.pow(1-d,2)*a.y+2*(1-d)*d*b.y+d*d*c.y,e},cubicBezier:function(a,b,c,d,e,f){return f=f||{},f.x=Math.pow(1-e,3)*a.x+3*Math.pow(1-e,2)*e*b.x+3*(1-e)*e*e*c.x+e*e*e*d.x,f.y=Math.pow(1-e,3)*a.y+3*Math.pow(1-e,2)*e*b.y+3*(1-e)*e*e*c.y+e*e*e*d.y,f},multicurve:function(a,b){var c,d,e,f;b.moveTo(a[0].x,a[0].y);for(var g=1;g<a.length-2;g+=1)c=a[g],d=a[g+1],e=(c.x+d.x)/2,f=(c.y+d.y)/2,b.quadraticCurveTo(c.x,c.y,e,f);c=a[a.length-2],d=a[a.length-1],b.quadraticCurveTo(c.x,c.y,d.x,d.y)}},particle=function(a,b,c,d,e){this.x=a,this.y=b,this.vx=Math.cos(d)*c*dt,this.vy=Math.sin(d)*c*dt,this.mass=1,this.radius=0,this.bounce=-1,this.friction=1,this.gravity=e||0,this.springs=[],this.gravitations=[],this.addGravitation=function(a){this.removeGravitation(a),this.gravitations.push(a)},this.removeGravitation=function(a){for(var b=0;b<this.gravitations.length;b+=1)if(a===this.gravitations[b])return void this.gravitations.splice(b,1)},this.addSpring=function(a,b,c){this.removeSpring(a),this.springs.push({point:a,k:b,length:c||0})},this.removeSpring=function(a){for(var b=0;b<this.springs.length;b+=1)if(a===this.springs[b].point)return void this.springs.splice(b,1)},this.getSpeed=function(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)},this.setSpeed=function(a){var b=this.getHeading();this.vx=Math.cos(b)*a,this.vy=Math.sin(b)*a},this.getHeading=function(){return Math.atan2(this.vy,this.vx)},this.setHeading=function(a){var b=this.getSpeed();this.vx=Math.cos(a)*b,this.vy=Math.sin(a)*b},this.accelerate=function(a,b){this.vx+=a,this.vy+=b},this.update=function(){0===dt&&(this.vx=Math.cos(d)*c*dt,this.vy=Math.sin(d)*c*dt),this.handleSprings(),this.handleGravitations(),this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy},this.handleGravitations=function(){for(var a=0;a<this.gravitations.length;a+=1)this.gravitateTo(this.gravitations[a])},this.handleSprings=function(){for(var a=0;a<this.springs.length;a+=1){var b=this.springs[a];this.springTo(b.point,b.k,b.length)}},this.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},this.distanceTo=function(a){var b=a.x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},this.gravitateTo=function(a){var b=a.x-this.x,c=a.y-this.y,d=b*b+c*c,e=Math.sqrt(d),f=a.mass/d,g=b/e*f,h=c/e*f;this.vx+=g,this.vy+=h},this.springTo=function(a,b,c){var d=a.x-this.x,e=a.y-this.y,f=Math.sqrt(d*d+e*e),g=(f-c||0)*b;this.vx+=d/f*g,this.vy+=e/f*g}};$.ajax({type:"GET",url:"game.xml",contentType:"text/xml",dataType:"text",async:!1,success:function(a){$(a).find("data").each(function(){X_Sound=parseInt($(this).find("sound").text()),X_Music=parseInt($(this).find("music").text()),X_Level=parseInt($(this).find("level").text()),X_Lives=parseInt($(this).find("player-lives").text()),X_PlayerSpeed=parseInt($(this).find("player-speed").text()),X_EnemySpeed=parseInt($(this).find("enemy-speed").text()),X_GunSpeed=parseInt($(this).find("reload-time").text()),X_EnGunSpeed=parseInt($(this).find("enreload-time").text()),X_BulletSpeed=parseInt($(this).find("bullet-speed").text()),X_EnBulletSpeed=parseInt($(this).find("enbullet-speed").text()),X_Title=$(this).find("title").text(),X_Subtitle=$(this).find("subtitle").text(),X_dt_Start=$(this).find("dt-start").text(),X_mb_Start=$(this).find("mb-start").text()})},error:function(){alert("The XML File could not be processed correctly.")}});var game={};game.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(game.isMobile=!0),game.score=0,game.levelScore=0,game.level=X_Level,game.bossDead=!1,game.levelComplete=!1,game.levelUpTimer=0,game.lives=X_Lives,game.keys=[],game.playerBullets=[],game.enemyBullets=[],game.enemies=[],game.waves=[],game.loot=[],game.explosions=[],dt=.017,dtTimer=0,dtArray=[],timeThen=(new Date).getTime(),game.loaded=!1,game.started=!1,game.paused=!1,game.gameOver=!1,game.timer=0,game.fadingIn=!1,game.fadingOut=!1,game.faded=!0,game.textFadingIn=!1,game.textFadingOut=!1,game.textFaded=!0,game.fullScreen=!1;var inputArea=document.getElementById("inputarea"),inputAreaX,inputAreaY,mouseIsDown=0,touchInitX=0,touchInitY=0,audioElementSupported=function(a){var b=a.createElement("audio"),c={},d="audio/";return"function"==typeof b.canPlayType?(c.supported=Boolean(!0),c.mp3=b.canPlayType(d+"mpeg"),c.wav=b.canPlayType(d+'wav; codecs="1"'),c.ogg=b.canPlayType(d+'ogg; codecs="vorbis"'),c.m4a=b.canPlayType(d+"x-m4a")||b.canPlayType(d+"aac"),c.webm=b.canPlayType(d+'webm; codecs="vorbis"')):c.supported=Boolean(0),c}(this.document);fileFormat=""!==audioElementSupported.m4a?".m4a":""!==audioElementSupported.ogg?".ogg":".mp3","localStorage"in window&&null!==window.localStorage?(game.sound="true"===localStorage.prawnsSound?!0:!1,game.music="true"===localStorage.prawnsMusic?!0:!1):(game.sound=!1,game.music=!1),game.sfx=[],game.doneSfx=0,game.requiredSfx=0,game.soundTracks=[],game.doneSoundTracks=0,game.requiredSoundTracks=0,game.sounds=[],game.tracks=[],game.images=[],game.doneImages=0,game.requiredImages=0,game.font=game.isMobile?"Helvetica":"Monaco",game.canvas1=document.getElementById("enemiesCanvas"),game.canvas2=document.getElementById("playerCanvas"),game.contextEnemies=game.canvas1.getContext("2d"),game.contextPlayer=game.canvas2.getContext("2d");var pixelRatio=window.devicePixelRatio>1.5?2:1;setGameDimensions(),gameBackground=new background,explosion.prototype=Object.create(particle.prototype),explosion.prototype.constructor=explosion;var playerShip;playerBullet.prototype=Object.create(particle.prototype),playerBullet.prototype.constructor=playerBullet,enemy.prototype=Object.create(particle.prototype),enemy.prototype.constructor=enemy,boss.prototype=Object.create(particle.prototype),boss.prototype.constructor=boss,enemyBullet.prototype=Object.create(particle.prototype),enemyBullet.prototype.constructor=enemyBullet,loot.prototype=Object.create(particle.prototype),loot.prototype.constructor=loot;var enemyWave=function(a,b,c,d,e,f,g,h){switch(this.side=a,this.spawnedShips=0,this.race=c,this.type=d,this.fleetSize=e,this.speed=f,this.hull=g,this.fireRate=h||0,this.spawnTimer=1,this.spawnDivision=Math.round(1500*dt),this.side){case"top":this.x=b,this.y=game.outerTop,this.direction=Math.PI/2;break;case"left":this.x=game.outerLeft,this.y=b,this.direction=0;break;case"right":this.x=game.outerRight,this.y=b,this.direction=Math.PI}this.over=!1,this.update=function(){this.spawnTimer++,this.spawnedShips<=this.fleetSize&&this.spawnTimer%this.spawnDivision==1&&(this.spawnTimer=1,game.enemies.push(new enemy(this.x,this.y,this.speed,this.direction,this.hull,this.type,this.race,this.fireRate,!0)),this.spawnedShips++),this.spawnedShips==this.fleetSize&&(this.over=!0)}};gameUI=new ui,gameLights=new lights,gameText=new text,gameState=new state,gameMenu=new menu;var level1={};level1.second1=function(){game.waves.push(new enemyWave("left",.3*game.width,"sectoid.png","pawn",1,300,1,0)),game.waves.push(new enemyWave("right",.3*game.width,"sectoid.png","pawn",1,250,1,0))},level1.second3=function(){game.waves.push(new enemyWave("left",.5*game.height,"sectoid.png","pawn",1,250,1,0)),game.waves.push(new enemyWave("right",.5*game.height,"sectoid.png","pawn",1,300,1,0))},level1.second5=function(){game.enemies.push(new enemy(.7*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second7=function(){game.enemies.push(new enemy(.3*game.width,game.outerTop,155,Math.PI/2,10,"base","alienbase1.png",1))},level1.second8=function(){game.waves.push(new enemyWave("left",.3*game.height,"sectoid.png","pawn",4,250,1,2))},level1.second9=function(){game.waves.push(new enemyWave("right",.2*game.height,"sectoid.png","pawn",3,300,1,2))},level1.second10=function(){game.waves.push(new enemyWave("top",.5*game.width,"sectoid.png","pawn",6,300,1,2))},level1.second11=function(){game.waves.push(new enemyWave("top",.7*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second12=function(){game.waves.push(new enemyWave("left",.2*game.height,"sectoid.png","pawn",3,300,1,2))},level1.second13=function(){game.enemies.push(new enemy(.3*game.width,game.outerTop,155,Math.PI/2,10,"base","alienbase2.png",1))},level1.second15=function(){game.waves.push(new enemyWave("top",.2*game.width,"sectoid.png","pawn",2,300,1,2))},level1.second16=function(){game.waves.push(new enemyWave("top",.4*game.width,"sectoid.png","pawn",3,300,1,2))},level1.second17=function(){game.waves.push(new enemyWave("top",.6*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second18=function(){game.waves.push(new enemyWave("top",.8*game.width,"sectoid.png","pawn",5,300,1,2))},level1.second22=function(){game.waves.push(new enemyWave("top",.3*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second25=function(){game.waves.push(new enemyWave("left",.4*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second27=function(){game.waves.push(new enemyWave("right",.3*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second30=function(){game.waves.push(new enemyWave("top",.3*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second33=function(){game.waves.push(new enemyWave("top",.6*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second35=function(){game.waves.push(new enemyWave("right",.2*game.width,"sectoid.png","pawn",4,300,1,2))},level1.second37=function(){game.enemies.push(new enemy(.2*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second38=function(){game.enemies.push(new enemy(.4*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second39=function(){game.enemies.push(new enemy(.6*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second40=function(){game.enemies.push(new enemy(.8*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second41=function(){game.enemies.push(new enemy(.5*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second42=function(){game.enemies.push(new enemy(.2*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second43=function(){game.enemies.push(new enemy(.4*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second44=function(){game.enemies.push(new enemy(.6*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.second45=function(){game.enemies.push(new enemy(.8*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","floater.png",2))},level1.update=function(){game.seconds>13&&game.tracks.length<2&&game.enemies.length>0&&!game.bossDead&&game.music&&(game.tracks.push(game.soundTracks["tune2"+fileFormat]),game.tracks[1].play(),game.tracks[1].loop=!0),game.seconds>50&&0===game.enemies.length&&!game.bossDead&&(game.music&&(game.tracks.push(game.soundTracks["boss"+fileFormat]),game.tracks[2].play(),game.tracks[2].loop=!0),game.enemies.push(new boss(.3*game.width,game.outerTop,150,Math.PI/2,50,"sectoidBoss.png"))),game.seconds>55&&0===game.enemies.length&&game.bossDead&&3==game.tracks.length&&(game.tracks[0].pause(),game.tracks[1].pause(),game.tracks[2].pause(),game.tracks=[],game.music&&0===game.tracks.length&&game.tracks.push(game.soundTracks["victory"+fileFormat]),game.tracks[0].play())},$(document).keydown(function(a){game.keys[a.keyCode?a.keyCode:a.which]=!0}),$(document).keyup(function(a){delete game.keys[a.keyCode?a.keyCode:a.which]});var loadingBar=$("#loadingBar"),loadingBarFiller=$("#loadingBarFiller"),loadingText=new text("Loading Images.. ","",!1);loadingText["switch"]("on"),loadingBar.show(),initImages(["_img/_dist/background/intro_bg.jpg","_img/_dist/ui/energybar.png","_img/_dist/ui/energypoint.png","_img/_dist/fighter/fighter.png","_img/_dist/fighter/fighter_right1.png","_img/_dist/fighter/fighter_right2.png","_img/_dist/fighter/fighter_right3.png","_img/_dist/fighter/fighter_right4.png","_img/_dist/fighter/fighter_right5.png","_img/_dist/fighter/fighter_left1.png","_img/_dist/fighter/fighter_left2.png","_img/_dist/fighter/fighter_left3.png","_img/_dist/fighter/fighter_left4.png","_img/_dist/fighter/fighter_left5.png","_img/_dist/enemies/sectoid.png","_img/_dist/enemies/_miniboss/floater.png","_img/_dist/enemies/_alienbase/alienbase1.png","_img/_dist/enemies/_alienbase/alienbase2.png","_img/_dist/enemies/_bigboss/sectoidBoss.png","_img/_dist/laser.png","_img/_dist/p_missile.png","_img/_dist/e_missile.png","_img/_dist/explosion.png"]),window.addEventListener("load",function a(){window.removeEventListener("load",a,!1),$(window).resize(respondCanvas),window.applicationCache.addEventListener("updateready",function b(){window.applicationCache.removeEventListener("updateready",b),window.applicationCache.status==window.applicationCache.UPDATEREADY&&confirm("A new version of InVaDeRs is available. Load it?")&&window.location.reload()},!1)},!1);var audiopreload=!1,timeout,waitTime=1e3,audioTest=new Audio;".mp3"===fileFormat?audioTest.src="data:audio/mpeg;base64,//MUxAAB6AXgAAAAAPP+c6nf//yi/6f3//MUxAMAAAIAAAjEcH//0fTX6C9Lf//0//MUxA4BeAIAAAAAAKX2/6zv//+IlR4f//MUxBMCMAH8AAAAABYWalVMQU1FMy45//MUxBUB0AH0AAAAADkuM1VVVVVVVVVV//MUxBgBUATowAAAAFVVVVVVVVVVVVVV":".m4a"===fileFormat?audioTest.src="data:audio/x-m4a;base64,AAAAGGZ0eXBNNEEgAAACAGlzb21pc28yAAAACGZyZWUAAAAfbWRhdN4EAABsaWJmYWFjIDEuMjgAAAFoAQBHAAACiG1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAYAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAG0dHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAYAAAAAAAAAAAAAAAAAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAABUG1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAArEQAAAQAVcQAAAAAAC1oZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU291bmRIYW5kbGVyAAAAAPttaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAL9zdGJsAAAAW3N0c2QAAAAAAAAAAQAAAEttcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAACdlc2RzAAAAAAMZAAEABBFAFQAAAAABftAAAAAABQISCAYBAgAAABhzdHRzAAAAAAAAAAEAAAABAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAXAAAAAQAAABRzdGNvAAAAAAAAAAEAAAAoAAAAYHVkdGEAAABYbWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAraWxzdAAAACOpdG9vAAAAG2RhdGEAAAABAAAAAExhdmY1Mi42NC4y":".ogg"===fileFormat&&(audioTest.src="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAD/QwAAAAAAAM2LVKsBHgF2b3JiaXMAAAAAAUSsAAAAAAAAgLsAAAAAAAC4AU9nZ1MAAAAAAAAAAAAA/0MAAAEAAADmvOe6Dy3/////////////////MgN2b3JiaXMdAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAwNzA2MjIAAAAAAQV2b3JiaXMfQkNWAQAAAQAYY1QpRplS0kqJGXOUMUaZYpJKiaWEFkJInXMUU6k515xrrLm1IIQQGlNQKQWZUo5SaRljkCkFmVIQS0kldBI6J51jEFtJwdaYa4tBthyEDZpSTCnElFKKQggZU4wpxZRSSkIHJXQOOuYcU45KKEG4nHOrtZaWY4updJJK5yRkTEJIKYWSSgelU05CSDWW1lIpHXNSUmpB6CCEEEK2IIQNgtCQVQAAAQDAQBAasgoAUAAAEIqhGIoChIasAgAyAAAEoCiO4iiOIzmSY0kWEBqyCgAAAgAQAADAcBRJkRTJsSRL0ixL00RRVX3VNlVV9nVd13Vd13UgNGQVAAABAEBIp5mlGiDCDGQYCA1ZBQAgAAAARijCEANCQ1YBAAABAABiKDmIJrTmfHOOg2Y5aCrF5nRwItXmSW4q5uacc845J5tzxjjnnHOKcmYxaCa05pxzEoNmKWgmtOacc57E5kFrqrTmnHPGOaeDcUYY55xzmrTmQWo21uaccxa0pjlqLsXmnHMi5eZJbS7V5pxzzjnnnHPOOeecc6oXp3NwTjjnnHOi9uZabkIX55xzPhmne3NCOOecc84555xzzjnnnHOC0JBVAAAQAABBGDaGcacgSJ+jgRhFiGnIpAfdo8MkaAxyCqlHo6ORUuoglFTGSSmdIDRkFQAACAAAIYQUUkghhRRSSCGFFFKIIYYYYsgpp5yCCiqppKKKMsoss8wyyyyzzDLrsLPOOuwwxBBDDK20EktNtdVYY62555xrDtJaaa211koppZRSSikIDVkFAIAAABAIGWSQQUYhhRRSiCGmnHLKKaigAkJDVgEAgAAAAgAAADzJc0RHdERHdERHdERHdETHczxHlERJlERJtEzL1ExPFVXVlV1b1mXd9m1hF3bd93Xf93Xj14VhWZZlWZZlWZZlWZZlWZZlWYLQkFUAAAgAAIAQQgghhRRSSCGlGGPMMeegk1BCIDRkFQAACAAgAAAAwFEcxXEkR3IkyZIsSZM0S7M8zdM8TfREURRN01RFV3RF3bRF2ZRN13RN2XRVWbVdWbZt2dZtX5Zt3/d93/d93/d93/d93/d1HQgNWQUASAAA6EiOpEiKpEiO4ziSJAGhIasAABkAAAEAKIqjOI7jSJIkSZakSZ7lWaJmaqZneqqoAqEhqwAAQAAAAQAAAAAAKJriKabiKaLiOaIjSqJlWqKmaq4om7Lruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7rui4QGrIKAJAAANCRHMmRHEmRFEmRHMkBQkNWAQAyAAACAHAMx5AUybEsS9M8zdM8TfRET/RMTxVd0QVCQ1YBAIAAAAIAAAAAADAkw1IsR3M0SZRUS7VUTbVUSxVVT1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTVN0zRNIDRkJQAABADAYo3B5SAhJSXl3hDCEJOeMSYhtV4hBJGS3jEGFYOeMqIMct5C4xCDHggNWREARAEAAMYgxxBzyDlHqZMSOeeodJQa5xyljlJnKcWYYs0oldhSrI1zjlJHraOUYiwtdpRSjanGAgAAAhwAAAIshEJDVgQAUQAAhDFIKaQUYow5p5xDjCnnmHOGMeYcc44556B0UirnnHROSsQYc445p5xzUjonlXNOSiehAACAAAcAgAALodCQFQFAnACAQZI8T/I0UZQ0TxRFU3RdUTRd1/I81fRMU1U90VRVU1Vt2VRVWZY8zzQ901RVzzRV1VRVWTZVVZZFVdVt03V123RV3ZZt2/ddWxZ2UVVt3VRd2zdV1/Zd2fZ9WdZ1Y/I8VfVM03U903Rl1XVtW3VdXfdMU5ZN15Vl03Vt25VlXXdl2fc103Rd01Vl2XRd2XZlV7ddWfZ903WF35VlX1dlWRh2XfeFW9eV5XRd3VdlVzdWWfZ9W9eF4dZ1YZk8T1U903RdzzRdV3VdX1dd19Y105Rl03Vt2VRdWXZl2fddV9Z1zzRl2XRd2zZdV5ZdWfZ9V5Z13XRdX1dlWfhVV/Z1WdeV4dZt4Tdd1/dVWfaFV5Z14dZ1Ybl1XRg+VfV9U3aF4XRl39eF31luXTiW0XV9YZVt4VhlWTl+4ViW3feVZXRdX1ht2RhWWRaGX/id5fZ943h1XRlu3efMuu8Mx++k+8rT1W1jmX3dWWZfd47hGDq/8OOpqq+brisMpywLv+3rxrP7vrKMruv7qiwLvyrbwrHrvvP8vrAso+z6wmrLwrDatjHcvm4sv3Acy2vryjHrvlG2dXxfeArD83R1XXlmXcf2dXTjRzh+ygAAgAEHAIAAE8pAoSErAoA4AQCPJImiZFmiKFmWKIqm6LqiaLqupGmmqWmeaVqaZ5qmaaqyKZquLGmaaVqeZpqap5mmaJqua5qmrIqmKcumasqyaZqy7LqybbuubNuiacqyaZqybJqmLLuyq9uu7Oq6pFmmqXmeaWqeZ5qmasqyaZquq3meanqeaKqeKKqqaqqqraqqLFueZ5qa6KmmJ4qqaqqmrZqqKsumqtqyaaq2bKqqbbuq7Pqybeu6aaqybaqmLZuqatuu7OqyLNu6L2maaWqeZ5qa55mmaZqybJqqK1uep5qeKKqq5ommaqqqLJumqsqW55mqJ4qq6omea5qqKsumatqqaZq2bKqqLZumKsuubfu+68qybqqqbJuqauumasqybMu+78qq7oqmKcumqtqyaaqyLduy78uyrPuiacqyaaqybaqqLsuybRuzbPu6aJqybaqmLZuqKtuyLfu6LNu678qub6uqrOuyLfu67vqucOu6MLyybPuqrPq6K9u6b+sy2/Z9RNOUZVM1bdtUVVl2Zdn2Zdv2fdE0bVtVVVs2TdW2ZVn2fVm2bWE0Tdk2VVXWTdW0bVmWbWG2ZeF2Zdm3ZVv2ddeVdV/XfePXZd3murLty7Kt+6qr+rbu+8Jw667wCgAAGHAAAAgwoQwUGrISAIgCAACMYYwxCI1SzjkHoVHKOecgZM5BCCGVzDkIIZSSOQehlJQy5yCUklIIoZSUWgshlJRSawUAABQ4AAAE2KApsThAoSErAYBUAACD41iW55miatqyY0meJ4qqqaq27UiW54miaaqqbVueJ4qmqaqu6+ua54miaaqq6+q6aJqmqaqu67q6Lpqiqaqq67qyrpumqqquK7uy7Oumqqqq68quLPvCqrquK8uybevCsKqu68qybNu2b9y6ruu+7/vCka3rui78wjEMRwEA4AkOAEAFNqyOcFI0FlhoyEoAIAMAgDAGIYMQQgYhhJBSSiGllBIAADDgAAAQYEIZKDRkRQAQJwAAGEMppJRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkgppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkqppJRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoplVJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSCgCQinAAkHowoQwUGrISAEgFAACMUUopxpyDEDHmGGPQSSgpYsw5xhyUklLlHIQQUmktt8o5CCGk1FJtmXNSWosx5hgz56SkFFvNOYdSUoux5ppr7qS0VmuuNedaWqs115xzzbm0FmuuOdecc8sx15xzzjnnGHPOOeecc84FAOA0OACAHtiwOsJJ0VhgoSErAYBUAAACGaUYc8456BBSjDnnHIQQIoUYc845CCFUjDnnHHQQQqgYc8w5CCGEkDnnHIQQQgghcw466CCEEEIHHYQQQgihlM5BCCGEEEooIYQQQgghhBA6CCGEEEIIIYQQQgghhFJKCCGEEEIJoZRQAABggQMAQIANqyOcFI0FFhqyEgAAAgCAHJagUs6EQY5Bjw1BylEzDUJMOdGZYk5qMxVTkDkQnXQSGWpB2V4yCwAAgCAAIMAEEBggKPhCCIgxAABBiMwQCYVVsMCgDBoc5gHAA0SERACQmKBIu7iALgNc0MVdB0IIQhCCWBxAAQk4OOGGJ97whBucoFNU6iAAAAAAAAwA4AEA4KAAIiKaq7C4wMjQ2ODo8AgAAAAAABYA+AAAOD6AiIjmKiwuMDI0Njg6PAIAAAAAAAAAAICAgAAAAAAAQAAAAICAT2dnUwAE7AwAAAAAAAD/QwAAAgAAADuydfsFAQEBAQEACg4ODg=="),audioTest.preload="auto",setTimeout(function(){audioTest.addEventListener("loadeddata",testpreload),timeout=setTimeout(testpreload,waitTime)
},0),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();