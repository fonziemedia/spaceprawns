function log(a,b){var c=a;console.log(c+": "+b)}function setGameDimensions(){var a=$("#gamearea"),b=$("canvas");game.isMobile||(game.windowWidth=parseInt(a.css("width"))*pixelRatio),b.attr("width",game.windowWidth*pixelRatio),b.attr("height",game.windowHeight*pixelRatio),game.context.scale(pixelRatio,pixelRatio),game.width=Math.round(game.windowWidth),game.height=Math.round(game.windowHeight),log("with: ",game.width),log("height: ",game.height),game.outerLeft=-Math.round(.1*game.width),game.outerRight=Math.round(game.width+.1*game.width),game.outerTop=-Math.round(.1*game.height),game.outerBottom=Math.round(game.height+.1*game.height),playerShip&&"undefined"!=typeof playerShip&&(playerShip.bulletspeed=Math.round(X_BulletSpeed*game.height/1e3),playerShip.limitX2=Math.round(game.width-.5*playerShip.width),playerShip.limitY2=Math.round(game.height-.5*playerShip.height),playerShip.movement=Math.round(.007*game.height)),!game.started&&playerShip&&"undefined"!=typeof playerShip&&(playerShip.x=Math.round(.46*game.width),playerShip.y=Math.round(.9*game.height))}function getNewExplosion(a,b,c,d,e,f){var g=null;game.explosionsPool.length>0?(g=game.explosionsPool.pop(),g.reset(a,b,c,d,e,f),g.sprite.reset(g.image,5,4,2),g.width=g.sprite.frameWidth,g.height=g.sprite.frameHeight,g.loadSound(),game.explosions.push(g)):(g=new explosion(a,b,c,d,e,f),g.loadSound(),game.explosions.push(g))}function freeExplosion(a){game.explosions.splice(game.explosions.indexOf(a),1),game.explosionsPool.push(a)}function getNewEnemy(a,b,c,d,e,f,g,h,i){var j=null;game.enemiesPool.length>0?(j=game.enemiesPool.pop(),j.sprite.reset(g,6,5,6),j.reset(a,b,c,d,e,f,g,h,i),game.enemies.push(j)):(j=new enemy(a,b,c,d,e,f,g,h,i),game.enemies.push(j))}function freeEnemy(a){game.enemies.splice(game.enemies.indexOf(a),1),game.enemiesPool.push(a)}function getNewLoot(a,b){var c=null;game.lootPool.length>0?(c=game.lootPool.pop(),c.reset(a,b),game.bullets.push(c)):(c=new loot(a,b),game.bullets.push(c))}function freeLoot(a){game.bullets.splice(game.bullets.indexOf(a),1),game.lootPool.push(a)}function getNewEnemyWave(a,b,c,d,e,f,g,h){var i=null;if(game.wavesPool.length>0){switch(i=game.wavesPool.pop(),i.side=a,i.spawnedShips=0,i.race=c,i.type=d,i.fleetSize=e,i.speed=f,i.hull=g,i.fireRate=h||0,i.spawnTimer=1,i.spawnDivision=Math.round(1500*dt),i.side){case"top":i.x=b,i.y=game.outerTop,i.direction=Math.PI/2;break;case"left":i.x=game.outerLeft,i.y=b,i.direction=0;break;case"right":i.x=game.outerRight,i.y=b,i.direction=Math.PI}i.over=!1,game.waves.push(i)}else i=new enemyWave(a,b,c,d,e,f,g,h),game.waves.push(i)}function freeEnemyWave(a){game.waves.splice(game.waves.indexOf(a),1),game.wavesPool.push(a)}function ui(){var a=$("#ui"),b=doc.getElementById("uiLevel"),c=doc.getElementById("uiScore"),d=doc.getElementById("uiEBar"),e=doc.getElementById("uiHangarList"),f=800;this.updateLevel=function(){b.innerHTML="STAGE "+game.level},this.updateScore=function(){c.innerHTML="SCORE: "+game.score},this.updateEnergy=function(){shipEnergy=playerShip.hull/playerShip.maxHull*100,shipEnergy<0&&(shipEnergy=0),shipEnergyPC=shipEnergy+"%",shipEnergy>=66?(d.classList.remove("eBar-red"),d.classList.remove("eBar-yellow"),d.classList.add("eBar-blue")):shipEnergy>=33&&shipEnergy<66?(d.classList.remove("eBar-red"),d.classList.add("eBar-yellow"),d.classList.remove("eBar-blue")):(d.classList.add("eBar-red"),d.classList.remove("eBar-yellow"),d.classList.remove("eBar-blue")),d.style.width=shipEnergyPC},this.updateHangar=function(){switch(playerShip.lives){case 3:e.getElementsByTagName("li")[0].style.display="inline-block",e.getElementsByTagName("li")[1].style.display="inline-block",e.getElementsByTagName("li")[2].style.display="inline-block";break;case 2:e.getElementsByTagName("li")[0].style.display="none";break;case 1:e.getElementsByTagName("li")[1].style.display="none";break;case 0:e.getElementsByTagName("li")[2].style.display="none"}},this.fade=function(b){switch(b){case"in":a.fadeIn(f);break;case"out":a.fadeOut(f)}},this.updateAll=function(){this.updateLevel(),this.updateScore(),this.updateEnergy(),this.updateHangar()}}function lights(){this.fader=$("#fader");var a=2e3;this["switch"]=function(a){switch(a){case"on":this.fader.hide(),game.faded=!1;break;case"off":this.fader.show(),game.faded=!0}},this.fade=function(b){switch(b){case"in":game.fadingIn=!0,this.fader.fadeOut(a,function(){game.fadingIn=!1,game.faded=!1});break;case"out":game.fadingOut=!0,this.fader.fadeIn(a,function(){game.fadingOut=!1,game.faded=!0})}}}function text(a,b,c){var d=$("#h1"),e=$("#h2"),f=$("#h3"),g=a,h=b,i=game.isMobile?"Tap screen to continue":"Press ENTER or LMB to continue",j=$(".all-text"),k=c,l=2e3;this["switch"]=function(a){switch(a){case"on":j.show(),game.textFaded=!1;break;case"off":j.stop(!0,!0),j.hide(),game.textFaded=!0}},this.fade=function(a){switch(a){case"in":game.textFadingIn=!0,j.fadeIn(l,function(){game.textFadingIn=!1,game.textFaded=!1});break;case"out":game.textFadingOut=!0,j.fadeOut(l,function(){d.text(""),e.text(""),f.text(""),game.textFadingOut=!1,game.textFaded=!0})}},this.init=function(){d.text(g),e.text(h),k?f.text(i):f.text("")},this.init()}function state(){this.start=function(){game.canVibrate&&navigator.vibrate(15),document.getElementById("resumeGame").disabled=!0,document.getElementById("startGame").disabled=!0,gameState.pause(),gameLights["switch"]("off"),removeGamePlayInput(),addStandByInput(),gameMenu.toggled&&gameMenu.toggle(),game.started?(game.score=0,game.level=1):game.started=!0,introBriefing=["Outside the galaxy","The outer space","AlphaPI 2034"],introText=new text("Stage "+game.level,introBriefing[game.level-1],!0),$(".menu-option-btn").promise().done(function(){$("#menuBackground").promise().done(function(){gameBackground.update(),introText.fade("in"),$(".all-text").promise().done(function(){removeStandByInput(),game.textFaded?(game.loaded||startGame(),addGamePlayInput(),resetGame(),gameLights.fade("in"),gameState.unPause(),document.getElementById("resumeGame").disabled=!1,document.getElementById("startGame").disabled=!1):$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),introText.fade("out"),$(".all-text").promise().done(function(){game.loaded||startGame(),addGamePlayInput(),resetGame(),gameLights.fade("in"),gameState.unPause(),document.getElementById("resumeGame").disabled=!1,document.getElementById("startGame").disabled=!1})})})})})},this.lvlComplete=function(){game.started=!1,removeGamePlayInput(),gameUI.fade("out"),levelUpText=new text("Stage Complete!",game.score+" enemy ships destroyed",!0),levelUpText["switch"]("on"),$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),levelUpText.fade("out"),$(".all-text").promise().done(function(){gameUI.fade("out"),gameLights.fade("out"),$("#fader").promise().done(function(){gameState.pause(),game.level++,gameState.start()})})})},this.gameOver=function(){game.started=!1,removeGamePlayInput(),gameUI.fade("out"),gameOverText=new text("Game Over",game.score+" enemy ships destroyed",!0),gameOverText["switch"]("on"),$("#inputarea").on("mousedown touchstart",function(){$("#inputarea").off("mousedown touchstart"),gameOverText.fade("out"),$(".all-text").promise().done(function(){gameUI.fade("out"),gameLights.fade("out"),$("#fader").promise().done(function(){gameState.pause(),game.score=0,game.level=1,gameLights.fade("out"),gameMenu.toggle()})})})},this.pause=function(){game.paused=!0,gameUI.fade("out")},this.unPause=function(){game.paused=!1,gameUI.updateAll(),gameUI.fade("in")}}function menu(){function a(){game.fullScreen=game.fullScreen?!1:!0,game.fullScreen?(g.addClass("active"),g.text("Fullscreen: ON")):(g.removeClass("active"),g.text("Fullscreen: OFF"))}var b=$("#menuBackground"),c=$("#resumeGame"),d=$("#startGame"),e=$("#toggleSound"),f=$("#toggleMusic"),g=$("#toggleFullScreen"),h=$("#credits"),i=$(".menu-option-btn"),j=800;this.toggled=!1,doc.addEventListener("fullscreenchange",a),doc.addEventListener("webkitfullscreenchange",a),doc.addEventListener("mozfullscreenchange",a),doc.addEventListener("MSFullscreenChange",a),this.toggleFullScreen=function(a){game.canVibrate&&navigator.vibrate(15),doc.fullscreenElement||doc.mozFullScreenElement||doc.webkitFullscreenElement||doc.msFullscreenElement?doc.exitFullscreen?doc.exitFullscreen():doc.msExitFullscreen?doc.msExitFullscreen():doc.mozCancelFullScreen?doc.mozCancelFullScreen():doc.webkitExitFullscreen&&doc.webkitExitFullscreen():doc.documentElement.requestFullscreen?doc.documentElement.requestFullscreen():doc.documentElement.msRequestFullscreen?doc.documentElement.msRequestFullscreen():doc.documentElement.mozRequestFullScreen?doc.documentElement.mozRequestFullScreen():doc.documentElement.webkitRequestFullscreen&&doc.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},this.toggleSound=function(){game.canVibrate&&navigator.vibrate(15),game.sound=game.sound?!1:!0,localStorage.prawnsSound=game.sound,game.sound?(e.addClass("active"),e.text("Sound: ON")):(e.removeClass("active"),e.text("Sound: OFF"))},this.toggleMusic=function(){if(game.canVibrate&&navigator.vibrate(15),game.music=game.music?!1:!0,localStorage.prawnsMusic=game.music,game.started&&game.tracks.length>0){for(var a in game.tracks)game.tracks[a].pause();game.tracks=[]}else if(game.started&&game.tracks.length<1){game.tracks.push(game.soundTracks["tune1"+fileFormat]);for(var b in game.tracks)game.tracks[b].play(),game.tracks[b].loop=!0}game.music?(f.addClass("active"),f.text("Music: ON")):(f.removeClass("active"),f.text("Music: OFF"))},this.toggle=function(){document.getElementById("toggle-menu-btn").disabled=!0,this.toggled=this.toggled?!1:!0,this.toggled?(gameState.pause(),i.css({display:"block"}),b.fadeIn(j),b.promise().done(function(){game.started?("Restart"!==d.text&&d.text("Restart"),c.animate({opacity:1,right:"-=50%"},800)):d.text("Start"),d.animate({opacity:1,left:"-=50%"},800),e.animate({opacity:1,right:"-=50%"},800),f.animate({opacity:1,left:"-=50%"},800),g.animate({opacity:1,right:"-=50%"},800),h.animate({opacity:1,left:"-=50%"},800),document.getElementById("toggle-menu-btn").disabled=!1})):(game.started&&c.animate({opacity:0,right:"+=50%"},800),d.animate({opacity:0,left:"+=50%"},800),e.animate({opacity:0,right:"+=50%"},800),f.animate({opacity:0,left:"+=50%"},800),g.animate({opacity:0,right:"+=50%"},800),h.animate({opacity:0,left:"+=50%"},800),i.promise().done(function(){i.hide(),b.fadeOut(j),b.promise().done(function(){game.loaded&&!game.faded&&gameState.unPause(),document.getElementById("toggle-menu-btn").disabled=!1})}))},this.init=function(){"true"===localStorage.prawnsSound?(e.addClass("active"),e.text("Sound: ON")):(e.removeClass("active"),e.text("Sound: OFF")),"true"===localStorage.prawnsMusic?(f.addClass("active"),f.text("Music: ON")):(f.removeClass("active"),f.text("Music: OFF")),"true"===localStorage.fullScreen?(g.addClass("active"),g.text("Fullscreen: ON")):(g.removeClass("active"),g.text("Fullscreen: OFF")),gameMenu.toggle()}}function update(){clrCanvas(),gameBackground.update(),dtTimerSet||(getDeltaTime(),console.log(dt)),updateGameTime(),game.seconds==Math.round(game.seconds)&&win["level"+game.level]["second"+game.seconds]&&win["level"+game.level]["second"+game.seconds](),win["level"+game.level].update(),game.enemies.length>0;for(var a=game.waves.length;a--;)game.waves[a].update();for(var b=game.enemies.length;b--;)game.enemies[b].update();game.bullets.length>0;for(var c=game.bullets.length;c--;)game.bullets[c].update();playerShip.load(),game.explosions.length>0;for(var d=game.explosions.length;d--;)game.explosions[d].update();if(game.sounds.length>0)for(var e in game.sounds)game.sounds[e].play(),game.sounds[e].addEventListener("paused",game.sounds.splice(e,1))}function respondCanvas(){game.paused=gameMenu.toggled?game.paused:!0,setGameDimensions(),game.paused=gameMenu.toggled?game.paused:!1}function addGamePlayInput(){inputAreaX=playerShip.x,inputAreaY=playerShip.y,inputArea.addEventListener("mousedown",mouseDown,!1),inputArea.addEventListener("mouseup",mouseUp,!1),inputArea.addEventListener("mousemove",mouseXY,!1),inputArea.addEventListener("touchstart",touchDown,!1),inputArea.addEventListener("touchend",touchUp,!1),inputArea.addEventListener("touchcancel",touchUp,!1),inputArea.addEventListener("touchleave",touchUp,!1),inputArea.addEventListener("touchmove",touchXY,!1)}function addStandByInput(){inputArea.addEventListener("mouseup",standByInput,!1),inputArea.addEventListener("touchstart",standByInput,!1)}function removeGamePlayInput(){inputArea.removeEventListener("mousedown",mouseDown,!1),inputArea.removeEventListener("mouseup",mouseUp,!1),inputArea.removeEventListener("mousemove",mouseXY,!1),inputArea.removeEventListener("touchstart",touchDown,!1),inputArea.removeEventListener("touchend",touchUp,!1),inputArea.removeEventListener("touchcancel",touchUp,!1),inputArea.removeEventListener("touchleave",touchUp,!1),inputArea.removeEventListener("touchmove",touchXY,!1)}function removeStandByInput(){inputArea.removeEventListener("mouseup",standByInput,!1),inputArea.removeEventListener("touchstart",standByInput,!1)}function mouseUp(a){a.preventDefault(),mouseIsDown=0}function touchUp(a){a.preventDefault(),mouseIsDown=0}function mouseDown(a){a.preventDefault(),mouseIsDown=1,touchInitX=a.pageX-inputArea.offsetLeft,touchInitY=a.pageY-inputArea.offsetTop}function touchDown(a){a.preventDefault(),mouseIsDown=1;var b=a.targetTouches[0];touchInitX=b.pageX-b.target.offsetLeft,touchInitY=b.pageY-b.target.offsetTop}function mouseXY(a){a.preventDefault(),inputAreaX=a.pageX-inputArea.offsetLeft,inputAreaY=a.pageY-inputArea.offsetTop}function touchXY(a){a.preventDefault();var b=a.targetTouches[0];inputAreaX=b.pageX-inputArea.offsetLeft,inputAreaY=b.pageY-inputArea.offsetTop}function standByInput(a){a.preventDefault(),game.fadingIn&&(gameLights.fader.stop(!0,!0),gameLights["switch"]("on")),game.fadingOut&&(gameLights.fader.stop(!0,!0),gameLights["switch"]("off")),game.textFadingIn&&($(".all-text").stop(!0,!0),gameText["switch"]("off")),game.textFadingOut&&($(".all-text").stop(!0,!0),gameText["switch"]("off"))}function getDeltaTime(){if(document.getElementById("toggle-menu-btn").disabled=!0,200>=dtTimer){var a=(new Date).getTime(),b=a-timeThen;if(dtArray.push(b),timeThen=a,dtTimer++,200==dtTimer){for(var c=0,d=0;d<dtArray.length-10;d++)c+=dtArray[d+10];dt=Math.ceil(c/dtArray.length)/1e3,dtTimerSet=!0,document.getElementById("toggle-menu-btn").disabled=!1}}}function updateGameTime(){game.timer++,game.seconds=game.timer/60||0}function clrCanvas(){game.context.clearRect(0,0,game.width,game.height)}function resetGame(){mouseIsDown=0,gameLights["switch"]("off"),clrCanvas(),game.bossDead=!1,game.levelComplete=!1,game.timer=0,game.levelUpTimer=0,playerShip.reset(),game.bullets=[],game.explosions=[],game.enemies=[],game.waves=[],game.loot=[],gameUI.updateAll(),game.sounds=[];for(var a in game.tracks)game.tracks[a].pause();game.tracks=[],game.music&&game.tracks.length<1&&(game.tracks.push(game.soundTracks["tune1"+fileFormat]),game.tracks[0].play(),game.tracks[0].loop=!0)}function Collision(a,b){return!(a.x>b.x+b.width||a.x+a.width<b.x||a.y>b.y+b.height||a.y+a.height<b.y)}function angleTo(a,b){return Math.atan2(b.y-a.y,b.x-a.x)}function loop(){requestAnimFrame(loop),game.paused||update()}function startGame(){game.loaded=!0,"undefined"==typeof win[playerShip]&&(playerShip=new player(10,15)),game.tracks.push(game.soundTracks["tune1"+fileFormat]),game.tracks.push(game.soundTracks["tune2"+fileFormat]),game.tracks.push(game.soundTracks["boss"+fileFormat]),game.tracks.push(game.soundTracks["victory"+fileFormat]);for(var a in game.tracks)game.tracks[a].play(),game.tracks[a].pause();game.tracks=[],game.sounds.push(game.sfx["laser"+fileFormat]),game.sounds.push(game.sfx["laser2"+fileFormat]),game.sounds.push(game.sfx["laser3"+fileFormat]),game.sounds.push(game.sfx["hit"+fileFormat]),game.sounds.push(game.sfx["hit2"+fileFormat]),game.sounds.push(game.sfx["hit3"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp2"+fileFormat]),game.sounds.push(game.sfx["loot_powerUp3"+fileFormat]),game.sounds.push(game.sfx["explosion"+fileFormat]),game.sounds.push(game.sfx["explosion2"+fileFormat]),game.sounds.push(game.sfx["explosion3"+fileFormat]),game.sounds.push(game.sfx["blast"+fileFormat]);for(var b in game.sounds)game.sounds[b].play(),game.sounds[b].pause();game.sounds=[],loop()}function imgEventHandler(){this.removeEventListener("load",imgEventHandler,!1);var a,b,c;a=this.src.split("/").pop(),a=a.substr(0,a.indexOf("."))||a,b=doc.createElement("canvas"),b.width=Math.round(this.width),b.height=Math.round(this.height),c=b.getContext("2d"),c.drawImage(this,0,0,b.width,b.height),game.offCtx[a]=b,game.doneImages++}function initImages(a){game.requiredImages=a.length;for(var b in a){var c=new Image;c.addEventListener("load",imgEventHandler,!1),c.src=a[b];var d=c.src.split("/").pop();game.images[d]=c}}function sfxEventHandler(){this.removeEventListener("canplaythrough",sfxEventHandler,!1),game.doneSfx++}function stEventHandler(){this.removeEventListener("canplaythrough",stEventHandler,!1),game.doneSoundTracks++}function initSfx(a){game.requiredSfx=a.length;for(var b in a){var c=new Audio;c.src=a[b];var d,e=c.src.split("/").pop();e in game.sfx?(d++,e=c.src.match(/([^\/]+)(?=\.\w+$)/)[0]+d+fileFormat,game.sfx[e]=c):(d=1,game.sfx[e]=c),console.log(audiopreload),audiopreload?(game.sfx[e].preload="auto",game.sfx[e].addEventListener("canplaythrough",sfxEventHandler,!1)):game.doneSfx++}}function initSoundTracks(a){game.requiredSoundTracks=a.length;for(var b in a){var c=new Audio;c.src=a[b];var d=c.src.split("/").pop();game.soundTracks[d]=c,audiopreload?(game.soundTracks[d].preload="auto",game.soundTracks[d].addEventListener("canplaythrough",stEventHandler,!1)):game.doneSoundTracks++}}function checkImages(){game.doneImages>=game.requiredImages?(loadingText=new text("Loading Sfx.. ","",!1),loadingBarFiller.css({width:"0"}),initSfx(game.sfxPaths),checkSfx()):(loadingBarWidth=game.doneImages/game.requiredImages*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkImages()},1))}function checkSfx(){game.doneSfx>=game.requiredSfx?(loadingText=new text("Loading Sound Tracks.. ","",!1),loadingBarFiller.css({width:"0"}),initSoundTracks(game.soundTrackPaths),checkSoundTracks()):(loadingBarWidth=game.doneSfx/game.requiredSfx*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkSfx()},1))}function checkSoundTracks(){game.doneSoundTracks>=game.requiredSoundTracks?(loadingText=new text("Loading Assets.. ","",!1),loadingBarFiller.css({width:"0"}),initObjects(),checkObjects()):(loadingBarWidth=game.doneSoundTracks/game.requiredSoundTracks*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkSoundTracks()},1))}function checkObjects(){game.doneObjects>=game.requiredObjects?(loadingText["switch"]("off"),loadingBar.hide(),gameMenu.init(),gameBackground=new background):(loadingBarWidth=game.doneObjects/game.requiredObjects*100+"%",loadingBarFiller.css({width:loadingBarWidth}),setTimeout(function(){checkObjects()},1))}function initObjects(){for(var a=1;a<=game.requiredWaves;a++)ew=new enemyWave(null,null,"enemy_sectoid","pawn",0,0,0,0),game.wavesPool.push(ew),game.doneObjects++;for(var c=1;c<=game.requiredEnemies;c++)en=new enemy(0,0,0,0,0,"pawn","enemy_sectoid",0),game.enemiesPool.push(en),game.doneObjects++;for(var d=1;d<=game.requiredPlayerBullets;d++)b=new playerBullet(null,null,null,-Math.PI/2,null,null,"bullet_p_laser"),game.playerBulletsPool.push(b),game.doneObjects++;for(var e=1;e<=game.requiredEnemyBullets;e++)eb=new enemyBullet(null,null,null,null,null,"bullet_e_missile"),game.enemyBulletsPool.push(eb),game.doneObjects++;for(var f=1;f<=game.requiredLoot;f++)l=new loot(null,null),game.lootPool.push(l),game.doneObjects++;for(var g=1;g<=game.requiredExplosions;g++)c=new explosion(null,null,null,null,"small",null),game.explosionsPool.push(c),game.doneObjects++}function toggleSound(){game.sound=game.sound?!1:!0,localStorage.prawnsSound=game.sound}function toggleMusic(){if(game.music=game.music?!1:!0,localStorage.prawnsMusic=game.music,game.tracks.length>0){for(var a in game.tracks)game.tracks[a].pause();game.tracks=[]}else if(game.tracks.length<1){game.tracks.push(game.soundTracks["tune1"+fileFormat]);for(var b in game.tracks)game.tracks[b].play(),game.tracks[b].loop=!0}}function windowLoadEvent(){win.removeEventListener("load",windowLoadEvent,!1),window.onresize=respondCanvas,win.applicationCache.addEventListener("updateready",appCacheEvent,!1),initImages(game.imagePaths),checkImages()}function appCacheEvent(){win.applicationCache.removeEventListener("updateready",appCacheEvent,!1),win.applicationCache.status==win.applicationCache.UPDATEREADY&&confirm("A new version of InVaDeRs is available. Load it?")&&win.location.reload()}function testpreload(a){clearTimeout(timeout),audioTest.removeEventListener("loadeddata",testpreload),audiopreload=void 0!==a&&"loadeddata"===a.type?!0:!1}var vector={_x:1,_y:0,create:function(a,b){var c=Object.create(this);return c.setX(a),c.setY(b),c},setX:function(a){this._x=a},getX:function(){return this._x},setY:function(a){this._y=a},getY:function(){return this._y},setAngle:function(a){var b=this.getLength();this._x=Math.cos(a)*b,this._y=Math.sin(a)*b},getAngle:function(){return Math.atan2(this._y,this._x)},setLength:function(a){var b=this.getAngle();this._x=Math.cos(b)*a,this._y=Math.sin(b)*a},getLength:function(){return Math.sqrt(this._x*this._x+this._y*this._y)},add:function(a){return vector.create(this._x+a.getX(),this._y+a.getY())},subtract:function(a){return vector.create(this._x-a.getX(),this._y-a.getY())},multiply:function(a){return vector.create(this._x*a,this._y*a)},divide:function(a){return vector.create(this._x/a,this._y/a)},addTo:function(a){this._x+=a.getX(),this._y+=a.getY()},subtractFrom:function(a){this._x-=a.getX(),this._y-=a.getY()},multiplyBy:function(a){this._x*=a,this._y*=a},divideBy:function(a){this._x/=a,this._y/=a}},utils={norm:function(a,b,c){return(a-b)/(c-b)},lerp:function(a,b,c){return(c-b)*a+b},map:function(a,b,c,d,e){return utils.lerp(utils.norm(a,b,c),d,e)},clamp:function(a,b,c){return Math.min(Math.max(a,Math.min(b,c)),Math.max(b,c))},distance:function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)},distanceXY:function(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)},circleCollision:function(a,b){return utils.distance(a,b)<=a.radius+b.radius},circlePointCollision:function(a,b,c){return utils.distanceXY(a,b,c.x,c.y)<c.radius},pointInRect:function(a,b,c){return utils.inRange(a,c.x,c.x+c.width)&&utils.inRange(b,c.y,c.y+c.height)},inRange:function(a,b,c){return a>=Math.min(b,c)&&a<=Math.max(b,c)},rangeIntersect:function(a,b,c,d){return Math.max(a,b)>=Math.min(c,d)&&Math.min(a,b)<=Math.max(c,d)},rectIntersect:function(a,b){return utils.rangeIntersect(a.x,a.x+a.width,b.x,b.x+b.width)&&utils.rangeIntersect(a.y,a.y+a.height,b.y,b.y+b.height)},degreesToRads:function(a){return a/180*Math.PI},radsToDegrees:function(a){return 180*a/Math.PI},randomRange:function(a,b){return a+Math.random()*(b-a)},randomInt:function(a,b){return Math.floor(a+Math.random()*(b-a+1))},roundToPlaces:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},roundNearest:function(a,b){return Math.round(a/b)*b},quadraticBezier:function(a,b,c,d,e){return e=e||{},e.x=Math.pow(1-d,2)*a.x+2*(1-d)*d*b.x+d*d*c.x,e.y=Math.pow(1-d,2)*a.y+2*(1-d)*d*b.y+d*d*c.y,e},cubicBezier:function(a,b,c,d,e,f){return f=f||{},f.x=Math.pow(1-e,3)*a.x+3*Math.pow(1-e,2)*e*b.x+3*(1-e)*e*e*c.x+e*e*e*d.x,f.y=Math.pow(1-e,3)*a.y+3*Math.pow(1-e,2)*e*b.y+3*(1-e)*e*e*c.y+e*e*e*d.y,f},multicurve:function(a,b){var c,d,e,f;b.moveTo(a[0].x,a[0].y);for(var g=1;g<a.length-2;g+=1)c=a[g],d=a[g+1],e=(c.x+d.x)/2,f=(c.y+d.y)/2,b.quadraticCurveTo(c.x,c.y,e,f);c=a[a.length-2],d=a[a.length-1],b.quadraticCurveTo(c.x,c.y,d.x,d.y)}},particle=function(a,b,c,d,e){this.x=a,this.y=b,this.speed=c,this.direction=d,this.vx=Math.cos(this.direction)*(this.speed*dt),this.vy=Math.sin(this.direction)*(this.speed*dt),this.mass=1,this.radius=0,this.bounce=-1,this.friction=1,this.gravity=e||0,this.springs=[],this.gravitations=[]};particle.prototype.update=function(){0===dt&&(this.vx=Math.cos(this.direction)*(this.speed*dt),this.vy=Math.sin(this.direction)*(this.speed*dt)),this.handleSprings(),this.handleGravitations(),this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy},particle.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&document.querySelector("meta[name=viewport]").setAttribute("content","initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no"),$.ajax({type:"GET",url:"game.xml",contentType:"text/xml",dataType:"text",async:!1,success:function(a){$(a).find("data").each(function(){X_Sound=parseInt($(this).find("sound").text()),X_Music=parseInt($(this).find("music").text()),X_Level=parseInt($(this).find("level").text()),X_Lives=parseInt($(this).find("player-lives").text()),X_PlayerSpeed=parseInt($(this).find("player-speed").text()),X_EnemySpeed=parseInt($(this).find("enemy-speed").text()),X_GunSpeed=parseInt($(this).find("reload-time").text()),X_EnGunSpeed=parseInt($(this).find("enreload-time").text()),X_BulletSpeed=parseInt($(this).find("bullet-speed").text()),X_EnBulletSpeed=parseInt($(this).find("enbullet-speed").text()),X_Title=$(this).find("title").text(),X_Subtitle=$(this).find("subtitle").text(),X_dt_Start=$(this).find("dt-start").text(),X_mb_Start=$(this).find("mb-start").text()})},error:function(){alert("The XML File could not be processed correctly.")}});var doc=document,win=window,game={};game.isMobile=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(game.isMobile=!0),game.background=[],game.score=0,game.levelScore=0,game.level=X_Level,game.bossDead=!1,game.levelComplete=!1,game.levelUpTimer=0,game.lives=X_Lives,game.keys=[],game.bullets=[],game.playerBulletsPool=[],game.enemyBulletsPool=[],game.lootPool=[],game.enemies=[],game.enemiesPool=[],game.waves=[],game.wavesPool=[],game.explosions=[],game.explosionsPool=[],game.requiredWaves=5,game.requiredEnemies=12,game.requiredPlayerBullets=70,game.requiredEnemyBullets=15,game.requiredLoot=5,game.requiredExplosions=20,game.requiredObjects=game.requiredWaves+game.requiredEnemies+game.requiredPlayerBullets+game.requiredEnemyBullets+game.requiredLoot+game.requiredExplosions,game.doneObjects=0;var dt=.017,dtTimer=0,dtArray=[],timeThen=(new Date).getTime();dtTimerSet=!1,game.loaded=!1,game.started=!1,game.paused=!1,game.gameOver=!1,game.timer=0,game.fadingIn=!1,game.fadingOut=!1,game.faded=!0,game.textFadingIn=!1,game.textFadingOut=!1,game.textFaded=!0,game.windowWidth=doc.documentElement.clientWidth,game.windowHeight=doc.documentElement.clientHeight,game.fullScreen=!1;var inputArea=doc.getElementById("inputarea"),inputAreaX,inputAreaY,mouseIsDown=0,touchInitX=0,touchInitY=0;game.canVibrate="vibrate"in navigator||"mozVibrate"in navigator,!game.canVibrate||"vibrate"in navigator||(navigator.vibrate=navigator.mozVibrate);var audioElementSupported=function(a){var b=a.createElement("audio"),c={},d="audio/";return"function"==typeof b.canPlayType?(c.supported=Boolean(!0),c.mp3=b.canPlayType(d+"mpeg"),c.wav=b.canPlayType(d+'wav; codecs="1"'),c.ogg=b.canPlayType(d+'ogg; codecs="vorbis"'),c.m4a=b.canPlayType(d+"x-m4a")||b.canPlayType(d+"aac"),c.webm=b.canPlayType(d+'webm; codecs="vorbis"')):c.supported=Boolean(0),c}(this.document);""!==audioElementSupported.m4a?fileFormat=".m4a":""!==audioElementSupported.ogg?fileFormat=".ogg":fileFormat=".mp3","localStorage"in win&&null!==win.localStorage?("true"===localStorage.prawnsSound?game.sound=!0:game.sound=!1,"true"===localStorage.prawnsMusic?game.music=!0:game.music=!1):(game.sound=!1,game.music=!1),game.sfxPaths=["_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/laser"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/hit"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/loot_powerUp"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/explosion"+fileFormat,"_sounds/_sfx/blast"+fileFormat],game.sfx=[],game.doneSfx=0,game.requiredSfx=0,game.soundTrackPaths=["_sounds/_soundTracks/_lvl1/tune1"+fileFormat,"_sounds/_soundTracks/_lvl1/tune2"+fileFormat,"_sounds/_soundTracks/_lvl1/victory"+fileFormat,"_sounds/_soundTracks/_lvl1/boss"+fileFormat],game.soundTracks=[],game.doneSoundTracks=0,game.requiredSoundTracks=0,game.sounds=[],game.tracks=[],!game.isMobile||win.innerHeight>=900?game.imagePaths=["_img/bg_level1_a.dkt.jpg","_img/bg_level1_b.dkt.jpg","_img/bg_level1_c.dkt.jpg","_img/player_ship.dkt.png","_img/player_ship_i.dkt.png","_img/player_shields.dkt.png","_img/enemy_sectoid.dkt.png","_img/enemy_floater.dkt.png","_img/enemy_base_sectoid.dkt.png","_img/enemy_base_floater.dkt.png","_img/boss_sectoid.dkt.png","_img/bullet_p_laser.dkt.png","_img/bullet_p_missile.dkt.png","_img/bullet_e_missile.dkt.png","_img/explosion_s0.dkt.png","_img/explosion_s1.dkt.png","_img/explosion_s2.dkt.png","_img/explosion_s3.dkt.png","_img/explosion_s4.dkt.png","_img/loot_lasers.dkt.png","_img/loot_missiles.dkt.png","_img/loot_shields.dkt.png"]:game.imagePaths=["_img/bg_level1_a.mob.jpg","_img/bg_level1_b.mob.jpg","_img/bg_level1_c.mob.jpg","_img/player_ship.mob.png","_img/player_ship_i.mob.png","_img/player_shields.mob.png","_img/enemy_sectoid.mob.png","_img/enemy_floater.mob.png","_img/enemy_base_sectoid.mob.png","_img/enemy_base_floater.mob.png","_img/boss_sectoid.mob.png","_img/bullet_p_laser.mob.png","_img/bullet_p_missile.mob.png","_img/bullet_e_missile.mob.png","_img/explosion_s0.mob.png","_img/explosion_s1.mob.png","_img/explosion_s2.mob.png","_img/explosion_s3.mob.png","_img/explosion_s4.mob.png","_img/loot_lasers.mob.png","_img/loot_missiles.mob.png","_img/loot_shields.mob.png"],
game.images=[],game.doneImages=0,game.requiredImages=0,game.offCtx=[],game.font=game.isMobile?"Helvetica":"Monaco",game.canvas=doc.getElementById("gameCanvas"),game.context=game.canvas.getContext("2d");var pixelRatio=win.devicePixelRatio>1.5?2:1;pixelRatio=game.isMobile&&1.5>pixelRatio?2:pixelRatio,pixelRatio=game.isMobile&&win.innerHeight>=900?1:pixelRatio,setGameDimensions(),sprite=function(a,b,c,d){for(this.image=game.offCtx[a],this.width=this.image.width,this.height=this.image.height,this.totalFrames=b*c,this.frameWidth=this.width/b,this.frameHeight=this.height/c,this.startFrame=0,this.endFrame=this.totalFrames-1,this.frameSpeed=d,this.ctx=game.context,this.animationSequence=[],this.fpr=Math.floor(this.image.width/this.frameWidth),this.frameNum=this.startFrame;this.frameNum<=this.endFrame;this.frameNum++)this.animationSequence.push(this.frameNum)},sprite.prototype.currentFrame=0,sprite.prototype.counter=0,sprite.prototype.reset=function(a,b,c,d){for(this.image=game.offCtx[a],this.width=this.image.width,this.height=this.image.height,this.totalFrames=b*c,this.frameWidth=this.width/b,this.frameHeight=this.height/c,this.startFrame=0,this.endFrame=this.totalFrames-1,this.frameSpeed=d,this.animationSequence=[],this.fpr=Math.floor(this.image.width/this.frameWidth),this.currentFrame=0,this.counter=0,this.frameNum=this.startFrame;this.frameNum<=this.endFrame;this.frameNum++)this.animationSequence.push(this.frameNum)},sprite.prototype.draw=function(a,b){this.ctx.drawImage(this.image,this.spriteCol*this.frameWidth,this.spriteRow*this.frameHeight,this.frameWidth,this.frameHeight,a,b,this.frameWidth,this.frameHeight),this.counter==this.frameSpeed-1&&(this.currentFrame=(this.currentFrame+1)%this.animationSequence.length),this.counter=(this.counter+1)%this.frameSpeed,this.spriteRow=Math.floor(this.animationSequence[this.currentFrame]/this.fpr),this.spriteCol=Math.floor(this.animationSequence[this.currentFrame]%this.fpr)},sprite.prototype.drawFrame=function(a,b,c){this.currentFrame=c%this.animationSequence.length,this.spriteRow=Math.floor(this.animationSequence[this.currentFrame]/this.fpr),this.spriteCol=Math.floor(this.animationSequence[this.currentFrame]%this.fpr),this.ctx.drawImage(this.image,this.spriteCol*this.frameWidth,this.spriteRow*this.frameHeight,this.frameWidth,this.frameHeight,a,b,this.frameWidth,this.frameHeight)},background=function(a){this.imageA=game.offCtx["bg_level"+game.level+"_a"],this.imageB=game.offCtx["bg_level"+game.level+"_b"],this.imageC=game.offCtx["bg_level"+game.level+"_c"],this.height=Math.round(this.imageA.height),this.width=Math.round(this.imageA.width),this.x=this.width<=game.windowWidth?0:Math.round(0-(this.width-game.windowWidth)/2),this.y1=0,this.y2=this.y1-this.height,this.y3=this.y2-this.height,this.yDrawLimit=!game.isMobile||win.innerHeight>=900?-1080:-640,this.speed=Math.round(200*dt),this.ctx=game.context},background.prototype.update=function(){this.y1+=this.speed,this.y2+=this.speed,this.y3+=this.speed,this.y1>=this.yDrawLimit&&this.y1<game.height?this.draw(this.imageA,this.x,this.y1):this.y1=this.y3-this.height,this.y2>=this.yDrawLimit&&this.y2<game.height?this.draw(this.imageB,this.x,this.y2):this.y2=this.y1-this.height,this.y3>=this.yDrawLimit&&this.y3<game.height?this.draw(this.imageC,this.x,this.y3):this.y3=this.y2-this.height},background.prototype.draw=function(a,b,c){this.ctx.drawImage(a,b,c)},explosion=function(a,b,c,d,e,f){switch(e){case"xSmall":this.image="explosion_s0";break;case"small":this.image="explosion_s1";break;case"medium":this.image="explosion_s2";break;case"large":this.image="explosion_s3";break;case"xLarge":this.image="explosion_s4"}this.sprite=new sprite(this.image,5,4,2),this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.speed=c,this.direction=d,this.target=f},explosion.prototype.dead=!1,explosion.prototype.audioHit1="hit"+fileFormat,explosion.prototype.audioHit2="hit2"+fileFormat,explosion.prototype.audioHit3="hit3"+fileFormat,explosion.prototype.audioDead1="explosion"+fileFormat,explosion.prototype.audioDead2="explosion2"+fileFormat,explosion.prototype.audioDead3="explosion3"+fileFormat,explosion.prototype.audioExplode="blast"+fileFormat,explosion.prototype.reset=function(a,b,c,d,e,f){switch(e){case"xSmall":this.image="explosion_s0";break;case"small":this.image="explosion_s1";break;case"medium":this.image="explosion_s2";break;case"large":this.image="explosion_s3";break;case"xLarge":this.image="explosion_s4"}this.x=Math.round(a-.2*this.width),this.y=Math.round(b-.2*this.height),this.speed=c,this.direction=d,this.target=f,this.dead=!1,this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt)},explosion.prototype.update=function(){this.dead?freeExplosion(this):(this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt),this.x+=this.vx,this.y+=this.vy,this.draw(this.x,this.y),this.sprite.currentFrame>=this.sprite.endFrame&&(this.dead=!0))},explosion.prototype.draw=function(a,b){this.sprite.draw(a,b)},explosion.prototype.loadSound=function(){game.sound&&("chasis"==this.target?game.sfx[this.audioHit1].paused?game.sounds.push(game.sfx[this.audioHit1]):game.sfx[this.audioHit2].paused?game.sounds.push(game.sfx[this.audioHit2]):game.sfx[this.audioHit3].paused&&game.sounds.push(game.sfx[this.audioHit3]):"enemy"==this.target?game.sfx[this.audioDead1].paused?game.sounds.push(game.sfx[this.audioDead1]):game.sfx[this.audioDead2].paused?game.sounds.push(game.sfx[this.audioDead2]):game.sfx[this.audioDead3].paused&&game.sounds.push(game.sfx[this.audioDead3]):("player"==this.target||"boss"==this.target)&&game.sounds.push(game.sfx[this.audioExplode]))},player=function(a,b){this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.speed=0,this.maxSpeed=400,this.hull=a,this.maxHull=a,this.bulletspeed=Math.round(X_BulletSpeed*game.height/1e3),this.audioFire1="laser"+fileFormat,this.audioFire2="laser2"+fileFormat,this.audioFire3="laser3"+fileFormat,this.rendered=!1,this.hit=!1,this.imune=!1,this.imuneTimer=0,this.dead=!1,this.deadTimer=0,this.lives=X_Lives,this.ctx=game.context,this.sprite=new sprite("player_ship",5,3,5),this.sprite_i=new sprite("player_ship_i",5,3,5),this.sprite_s=new sprite("player_shields",3,2,5),this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.speedX=0,this.speedY=0,this.limitX1=Math.round(.5*-this.width),this.limitX2=Math.round(game.width-.5*this.width),this.limitY1=Math.round(.5*-this.height),this.limitY2=Math.round(game.height-.5*this.height),this.movement=Math.round(.007*game.height),this.bulletTimer=1,this.bulletDivision=b,this.laserLevel=1,this.missileLevel=0,this.midLaserX=Math.round(this.x+.5*this.width),this.leftlaserX=Math.round(this.x+.25*this.width),this.rightlaserX=Math.round(this.x+.75*this.width),this.LaserY=Math.round(this.y-.2*this.height)},player.prototype.update=function(){if(this.speed=0,this.speedX=Math.round(.1*(touchInitX-inputAreaX)/pixelRatio),this.speedY=Math.round(.1*(touchInitY-inputAreaY)/pixelRatio),!mouseIsDown||game.levelComplete||game.paused||game.gameOver?(this.spriteFrame=10,doc.getElementById("gamearea").style.cursor="crosshair"):(game.isMobile||(doc.getElementById("gamearea").style.cursor="none"),moveRight1=this.speedX<-2&&this.speedX>=-4?!0:!1,moveRight2=this.speedX<-4&&this.speedX>=-6?!0:!1,moveRight3=this.speedX<-6&&this.speedX>=-8?!0:!1,moveRight4=this.speedX<-8&&this.speedX>=-10?!0:!1,moveRight5=this.speedX<-10?!0:!1,moveLeft1=this.speedX>2&&this.speedX<=4?!0:!1,moveLeft2=this.speedX>4&&this.speedX<=6?!0:!1,moveLeft3=this.speedX>6&&this.speedX<=8?!0:!1,moveLeft4=this.speedX>8&&this.speedX<=10?!0:!1,moveLeft5=this.speedX>10?!0:!1,this.speedX=this.speedX<this.movement?this.speedX:this.movement,this.speedY=this.speedY<this.movement?this.speedY:this.movement,this.speedX=this.speedX>-this.movement?this.speedX:-this.movement,this.speedY=this.speedY>-this.movement?this.speedY:-this.movement,(0!==this.speedX||0!==this.speedY)&&(this.x>=this.limitX1&&this.x<=this.limitX2&&this.y>=this.limitY1&&this.y<=this.limitY2?(this.x=this.x-this.speedX,this.y=this.y-this.speedY):this.x<this.limitX1?this.x=this.limitX2:this.x>this.limitX2?this.x=this.limitX1:this.y<this.limitY1?this.y=this.limitY2:this.y>this.limitY2&&(this.y=this.limitY1)),this.speedX=0,this.speedY=0,moveRight1?this.spriteFrame=5:moveRight2?this.spriteFrame=6:moveRight3?this.spriteFrame=7:moveRight4?this.spriteFrame=8:moveRight5?this.spriteFrame=9:moveLeft1?this.spriteFrame=0:moveLeft2?this.spriteFrame=1:moveLeft3?this.spriteFrame=2:moveLeft4?this.spriteFrame=3:moveLeft5&&(this.spriteFrame=4),this.rendered=!1),game.isMobile||((game.keys[37]||game.keys[65]&&!game.gameOver)&&this.x>0&&(this.speed=this.maxSpeed,this.image=this.offCanvasL5,this.rendered=!1,this.x-=Math.round(this.speed*dt)),(game.keys[39]||game.keys[68]&&!game.gameOver)&&this.x<=game.width-this.width&&(this.speed=this.maxSpeed,this.image=this.offCanvasR5,this.rendered=!1,this.x+=Math.round(this.speed*dt)),!game.keys[38]&&!game.keys[87]||game.gameOver||this.y>0&&(this.speed=this.maxSpeed,this.rendered=!1,this.y-=Math.round(this.speed*dt)),(game.keys[40]||game.keys[83]&&!game.gameOver)&&this.y<=game.height-this.height&&(this.speed=this.maxSpeed,this.rendered=!1,this.y+=Math.round(this.speed*dt))),game.levelComplete&&(this.speed=2*this.maxSpeed,this.rendered=!1,this.y-=Math.round(this.speed*dt)),this.midLaserX=Math.round(this.x+.5*this.width),this.leftLaserX=Math.round(this.x+.25*this.width),this.rightLaserX=Math.round(this.x+.75*this.width),this.laserY=Math.round(this.y-.2*this.height),this.midMissileX=Math.round(this.x+.5*this.width),this.leftMissileX=this.x,this.rightMissileX=this.x+this.width,this.missileY=this.y+this.height,!game.keys[32]&&!mouseIsDown||this.dead||game.gameOver)this.bulletTimer=1;else if(this.bulletTimer++,this.bulletTimer%this.bulletDivision===0){switch(this.laserLevel){case 1:getNewBullet(this.midLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]));break;case 2:getNewBullet(this.leftLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),getNewBullet(this.rightLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]));break;case 3:getNewBullet(this.leftLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),getNewBullet(this.midLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),getNewBullet(this.rightLaserX,this.laserY,600,-Math.PI/2,1,1,"bullet_p_laser"),game.sound&&(game.sfx[this.audioFire1].paused?game.sounds.push(game.sfx[this.audioFire1]):game.sfx[this.audioFire2].paused?game.sounds.push(game.sfx[this.audioFire2]):game.sfx[this.audioFire3].paused&&game.sounds.push(game.sfx[this.audioFire3]))}switch(this.missileLevel){case 0:break;case 1:getNewBullet(this.midMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile");break;case 2:getNewBullet(this.leftMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile"),getNewBullet(this.rightMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile");break;case 3:getNewBullet(this.leftMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile"),getNewBullet(this.midMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile"),getNewBullet(this.rightMissileX,this.missileY,100,-Math.PI/2,2,1.03,"bullet_p_missile")}}this.hull<=0&&!this.dead&&(this.dead=!0,this.lives-=1,getNewExplosion(this.x,this.y,0,0,"large","player"),gameUI.updateHangar()),this.dead&&this.deadTimer<=100&&(this.deadTimer++,this.deadTimer>100&&this.lives>0?(mouseIsDown=0,this.hull=10,this.dead=!1,this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.image=this.offCanvas,this.rendered=!1,this.hit=!1,this.friction=0,this.laserLevel=1,this.missileLevel=0,gameUI.updateEnergy(),this.deadTimer=0,this.imune=!0,this.imuneTimer=0):this.deadTimer>100&&0===this.lives&&!game.gameOver?(mouseIsDown=0,game.keys[13]=!1,this.deadTimer=0,game.gameOver=!0,gameState.gameOver()):(this.x=Math.round(.5*game.width),this.y=Math.round(1.5*game.height))),this.imune&&(this.imuneTimer++,this.imuneTimer>250&&(this.imune=!1,this.imuneTimer=0))},player.prototype.draw=function(){this.dead||(this.imune?(this.imuneTimer>=0&&this.imuneTimer<15||this.imuneTimer>=20&&this.imuneTimer<35||this.imuneTimer>=40&&this.imuneTimer<55||this.imuneTimer>=70&&this.imuneTimer<75||this.imuneTimer>=90&&this.imuneTimer<95||this.imuneTimer>=110&&this.imuneTimer<115||this.imuneTimer>=130&&this.imuneTimer<135||this.imuneTimer>=150&&this.imuneTimer<155||this.imuneTimer>=160&&this.imuneTimer<175||this.imuneTimer>180)&&this.sprite_i.drawFrame(this.x,this.y,this.spriteFrame):this.sprite.drawFrame(this.x,this.y,this.spriteFrame),this.hit&&!this.imune&&(game.canVibrate&&this.sprite_s.currentFrame<1&&navigator.vibrate(30),this.sprite_s.draw(this.x-.7*this.width,this.y-.1*this.height),this.sprite_s.currentFrame>=this.sprite_s.endFrame&&(this.hit=!1,this.sprite_s.counter=0,this.sprite_s.currentFrame=0)))},player.prototype.load=function(){this.update(),this.draw()},player.prototype.reset=function(){game.gameOver=!1,this.dead=!1,this.deadTimer=0,this.x=Math.round(.46*game.width),this.y=Math.round(.9*game.height),this.spriteFrame=10,this.hull=10,this.rendered=!1,this.hit=!1,this.friction=0,this.laserLevel=1,this.missileLevel=0,this.lives=X_Lives};var playerShip=null;playerBullet=function(a,b,c,d,e,f,g){this.sprite=new sprite(g,3,1,4),this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.x=Math.round(a-.5*this.width),this.y=Math.round(b-.5*this.height),this.speed=c,this.direction=d,this.power=e,this.friction=f,this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt)},playerBullet.prototype.dead=!1,playerBullet.prototype.ctx=game.context,playerBullet.prototype.reset=function(a,b,c,d,e){this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.x=Math.round(a-.5*this.width),this.y=Math.round(b-.5*this.height),this.speed=c,this.power=d,this.friction=e,this.dead=!1,this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt)},playerBullet.prototype.update=function(){if(this.dead)freeBullet(this);else{this.vx*=this.friction,this.vy*=this.friction,this.x+=this.vx,this.y+=this.vy,this.draw(this.x,this.y);for(var a in game.enemies)Collision(game.enemies[a],this)&&(game.enemies[a].hull-=this.power,game.enemies[a].hull>0&&getNewExplosion(game.enemies[a].x+.5*game.enemies[a].width,game.enemies[a].y+.5*game.enemies[a].height,0,1,"xSmall","chasis"),this.dead=!0);this.y<game.outerTop&&(this.dead=!0)}},playerBullet.prototype.draw=function(a,b){this.sprite.draw(a,b)},getNewBullet=function(a,b,c,d,e,f,g){var h=null;game.playerBulletsPool.length>0?(h=game.playerBulletsPool.pop(),h.sprite.reset(g,3,1,4),h.reset(a,b,c,e,f,g),game.bullets.push(h)):(h=new playerBullet(a,b,c,d,e,f,g),game.bullets.push(h))},freeBullet=function(a){game.bullets.splice(game.bullets.indexOf(a),1),game.playerBulletsPool.push(a)},enemy=function(a,b,c,d,e,f,g,h,i){switch(this.x=a,this.y=b,this.image=game.offCtx[g],this.width=game.offCtx[g].width,this.height=game.offCtx[g].height,this.hull=e,this.sprite=new sprite(g,6,5,5),this.type=f,f){case"pawn":this.explosionSize="medium";break;case"miniboss":this.explosionSize="large";break;case"base":this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.explosionSize="xLarge"}this.sheep=i||!1,this.fireRate=60*h||0,this.bulletDivision=this.sheep?2*this.fireRate-Math.floor(Math.random()*this.fireRate)||99999:this.bulletDivision=this.fireRate||99999,this.speed=c/pixelRatio,this.direction=d},enemy.prototype.bulletTimer=1,enemy.prototype.hitTimer=0,enemy.prototype.ctx=game.context,enemy.prototype.dead=!1,enemy.prototype.collided=!1,enemy.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},enemy.prototype.reset=function(a,b,c,d,e,f,g,h,i){switch(this.x=a,this.y=b,this.speed=c,this.direction=d,this.hull=e,this.type=f,this.image=game.offCtx[g],this.sheep=i||!1,this.fireRate=60*h||0,this.width=game.offCtx[g].width,this.height=game.offCtx[g].height,f){case"pawn":this.explosionSize="medium";break;case"miniboss":this.explosionSize="large";break;case"base":this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.explosionSize="xLarge"}this.bulletTimer=1,this.hitTimer=0,this.collided=!1,this.dead=!1,this.bulletDivision=this.sheep?2*this.fireRate-Math.floor(Math.random()*this.fireRate)||99999:this.bulletDivision=this.fireRate||99999,this.vx=Math.cos(this.direction)*(this.speed*dt),this.vy=Math.sin(this.direction)*(this.speed*dt)},enemy.prototype.update=function(){this.dead?freeEnemy(this):(this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt),this.x+=this.vx,this.y+=this.vy,"base"!==this.type&&(this.direction-=utils.randomRange(-.05,.05)),this.draw(this.x,this.y),0!==this.fireRate&&(this.bulletTimer++,this.bulletTimer%this.bulletDivision==1&&(this.bulletTimer=1,bulletX=Math.round(this.x+.42*this.width),bulletY=Math.round(this.y+this.height),getNewEnemyBullet(bulletX,bulletY,50,angleTo(this,playerShip),1,"bullet_e_missile"))),!Collision(this,playerShip)||this.dead||playerShip.imune||game.gameOver||(getNewExplosion(playerShip.x,playerShip.y,0,1,"small","chasis"),playerShip.hull-=this.hull,gameUI.updateEnergy(),playerShip.hit=!0,this.hull-=playerShip.hull),this.hull<=0&&(this.dead=!0,getNewExplosion(this.x,this.y,this.speed,this.direction,this.explosionSize,"enemy"),lootchance=Math.random(),lootchance<.4&&getNewLoot(this.x,this.y),playerShip.crashed||(game.score++,game.levelScore++,gameUI.updateScore())),(this.x>game.outerRight||this.x<game.outerLeft||this.y>game.outerBottom||this.y<game.outerTop)&&(this.dead=!0))},enemy.prototype.draw=function(a,b){"base"!==this.type?this.ctx.drawImage(this.image,a,b):this.sprite.draw(a,b)},boss=function(a,b,c,d,e,f){this.speed=c,this.direction=d,this.hull=e,this.image=game.offCtx[f],this.width=game.offCtx[f].width,this.height=game.offCtx[f].height,this.x=game.width/2-this.width/2,this.y=game.outerTop,this.hit=!1,this.audioHit1="hit"+fileFormat,this.audioHit2="hit2"+fileFormat,this.audioHit3="hit3"+fileFormat,this.hitTimer=0,this.dead=!1,this.deadTimer=0,this.bulletTimer1=1,this.bulletTimer2=1,this.bulletDivision1=50,this.bulletDivision2=30,this.fireRate=0,this.yStop=Math.round(.05*game.height),this.xBondary=Math.round(game.width-this.width/4),this.ctx=game.context},boss.prototype.update=function(){this.dead?(game.levelUpTimer++,100==game.levelUpTimer&&(game.levelComplete=!0,gameState.lvlComplete(),mouseIsDown=0)):(this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt),this.x+=this.vx,this.y+=this.vy,this.draw(this.x,this.y),this.hit&&this.hull>0&&(game.sound&&(game.sfx[this.audioHit1].paused?game.sounds.push(game.sfx[this.audioHit1]):game.sfx[this.audioHit2].paused?game.sounds.push(game.sfx[this.audioHit2]):game.sfx[this.audioHit3].paused&&game.sounds.push(game.sfx[this.audioHit3])),this.hit=!1),!Collision(playerShip,this)||this.dead||game.gameOver||(playerShip.hull-=this.hull,playerShip.hit=!0,this.hit=!0,this.hull-=playerShip.hull),this.hull<=0&&(getNewExplosion(this.x,this.y,this.speed,this.direction,"xLarge","boss"),playerShip.crashed||(game.score++,game.levelScore++,gameUI.updateScore(),game.bossDead=!0,this.dead=!0)),this.bulletTimer1++,this.bulletTimer2++,this.bulletTimer1%this.bulletDivision1==1&&(this.bulletTimer1=1,mBulletX1=Math.round(this.x),mBulletX2=Math.round(this.x+this.width),mBulletY=Math.round(this.y+.6*this.height),getNewEnemyBullet(mBulletX1,mBulletY,50,angleTo(this,playerShip),1,"bullet_e_missile"),getNewEnemyBullet(mBulletX2,mBulletY,50,angleTo(this,playerShip),1,"bullet_e_missile")),this.bulletTimer2%this.bulletDivision2==1&&(this.bulletTimer2=1,lBulletX1=Math.round(this.x+.4*this.width),lBulletX2=Math.round(this.x+.6*this.width),lBulletY=Math.round(this.y+this.height),getNewEnemyBullet(lBulletX1,lBulletY,250,Math.PI/2,1.5,"bullet_p_laser"),getNewEnemyBullet(lBulletX2,lBulletY,250,Math.PI/2,1.5,"bullet_p_laser")),this.y>this.yStop&&(this.speed=0,this.x>0&&this.x<=this.xBondary&&(this.x<playerShip.x&&this.x<=this.xBondary-1?this.x+=1:this.x>playerShip.x&&this.x>1&&(this.x-=1))))},boss.prototype.draw=function(a,b){this.ctx.drawImage(this.image,a,b)},enemyBullet=function(a,b,c,d,e,f){this.sprite=new sprite(f,3,1,5),this.x=a,this.y=b,this.power=e,this.speed=c,this.direction=d,this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt),this.spriteX=-Math.round(.5*this.width),this.spriteY=-Math.round(.5*this.height)},enemyBullet.prototype.dead=!1,enemyBullet.prototype.friction=1.02,enemyBullet.prototype.ctx=game.context,enemyBullet.prototype.reset=function(a,b,c,d,e){this.x=a,this.y=b,this.width=this.sprite.frameWidth,this.height=this.sprite.frameHeight,this.speed=c,this.direction=d,this.power=e,this.dead=!1,this.vx=Math.cos(this.direction)*(this.speed/pixelRatio*dt),this.vy=Math.sin(this.direction)*(this.speed/pixelRatio*dt)},enemyBullet.prototype.update=function(){this.dead?freeEnemyBullet(this):(this.vx*=this.friction,this.vy*=this.friction,this.x+=this.vx,this.y+=this.vy,this.draw(this.x,this.y),!Collision(this,playerShip)||playerShip.imune||game.gameOver||(getNewExplosion(this.x,this.y,0,1,"xSmall","chasis"),playerShip.hull-=this.power,gameUI.updateEnergy(),playerShip.hit=!0,this.dead=!0),(this.x>game.outerRight||this.x<game.outerLeft||this.y>game.outerBottom||this.y<game.outerTop)&&(this.dead=!0))},enemyBullet.prototype.draw=function(a,b){this.ctx.save(),this.ctx.translate(a,b),this.ctx.rotate(this.direction-Math.PI/2),this.sprite.draw(this.spriteX,this.spriteY),this.ctx.restore()},getNewEnemyBullet=function(a,b,c,d,e,f){var g=null;game.enemyBulletsPool.length>0?(g=game.enemyBulletsPool.pop(),g.sprite.reset(f,3,1,4),g.reset(a,b,c,d,e),game.bullets.push(g)):(g=new enemyBullet(a,b,c,d,e,f),game.bullets.push(g))},freeEnemyBullet=function(a){game.bullets.splice(game.bullets.indexOf(a),1),game.enemyBulletsPool.push(a)},loot=function(a,b){switch(this.x=a,this.y=b,this.dead=!1,this.key=Math.floor(Math.random()*this.drops.length),this.type=this.drops[this.key],this.type){case"health":this.image=game.offCtx.loot_shields;break;case"laser":this.image=game.offCtx.loot_lasers;break;case"missile":this.image=game.offCtx.loot_missiles}this.width=this.image.width,this.height=this.image.height},loot.prototype.speed=Math.round(250/pixelRatio),loot.prototype.direction=Math.PI/2,loot.prototype.dead=!1,loot.prototype.drops=["health","laser","missile"],loot.prototype.sfx1="loot_powerUp"+fileFormat,loot.prototype.sfx2="loot_powerUp2"+fileFormat,loot.prototype.sfx3="loot_powerUp3"+fileFormat,loot.prototype.ctx=game.context,loot.prototype.reset=function(a,b){switch(this.x=a,this.y=b,this.dead=!1,this.key=Math.floor(Math.random()*this.drops.length),this.type=this.drops[this.key],this.type){case"health":this.image=game.offCtx.loot_shields;break;case"laser":this.image=game.offCtx.loot_lasers;break;case"missile":this.image=game.offCtx.loot_missiles}},loot.prototype.update=function(){if(this.dead)freeLoot(this);else{if(this.vx=Math.cos(this.direction)*(this.speed*dt),this.vy=Math.sin(this.direction)*(this.speed*dt),this.x+=this.vx,this.y+=this.vy,this.draw(this.x,this.y),Collision(this,playerShip)){switch(this.type){case"health":this.hull<=7.5?playerShip.hull+=2.5:playerShip.hull=10,gameUI.updateEnergy();break;case"laser":playerShip.laserLevel=playerShip.laserLevel<3?playerShip.laserLevel+1:playerShip.laserLevel;break;case"missile":playerShip.missileLevel=playerShip.missileLevel<3?playerShip.missileLevel+1:playerShip.missileLevel}game.sound&&(game.sfx[this.sfx1].paused?game.sounds.push(game.sfx[this.sfx1]):game.sfx[this.sfx2].paused?game.sounds.push(game.sfx[this.sfx2]):game.sfx[this.sfx3].paused&&game.sounds.push(game.sfx[this.sfx3])),this.dead=!0}this.y>game.outerBottom&&(this.dead=!0)}},loot.prototype.draw=function(a,b){this.ctx.drawImage(this.image,a,b)};var enemyWave=function(a,b,c,d,e,f,g,h){switch(this.side=a,this.spawnedShips=0,this.race=c,this.type=d,this.fleetSize=e,this.speed=f,this.hull=g,this.fireRate=h||0,this.spawnTimer=1,this.spawnDivision=Math.round(1500*dt/pixelRatio),this.side){case"top":this.x=b,this.y=game.outerTop,this.direction=Math.PI/2;break;case"left":this.x=game.outerLeft,this.y=b,this.direction=0;break;case"right":this.x=game.outerRight,this.y=b,this.direction=Math.PI}this.over=!1,this.update=function(){this.over?freeEnemyWave(this):(this.spawnTimer++,this.spawnedShips<=this.fleetSize&&this.spawnTimer==this.spawnDivision&&(this.spawnTimer=1,getNewEnemy(this.x,this.y,this.speed,this.direction,this.hull,this.type,this.race,this.fireRate,!0),this.spawnedShips++),this.spawnedShips==this.fleetSize&&(this.over=!0))}};gameUI=new ui,gameLights=new lights,gameText=new text,gameState=new state,gameMenu=new menu;var level1={};level1.second1=function(){getNewEnemyWave("left",.3*game.width,"enemy_sectoid","pawn",1,300,1,0),getNewEnemyWave("right",.3*game.width,"enemy_sectoid","pawn",1,250,1,0)},level1.second3=function(){getNewEnemyWave("left",.5*game.height,"enemy_sectoid","pawn",1,250,1,0),getNewEnemyWave("right",.5*game.height,"enemy_sectoid","pawn",1,300,1,0)},level1.second5=function(){getNewEnemy(.7*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second7=function(){getNewEnemy(.3*game.width,game.outerTop,155,Math.PI/2,10,"base","enemy_base_sectoid",1)},level1.second8=function(){getNewEnemyWave("left",.3*game.height,"enemy_sectoid","pawn",4,250,1,2)},level1.second9=function(){getNewEnemyWave("right",.2*game.height,"enemy_sectoid","pawn",3,300,1,2)},level1.second10=function(){getNewEnemyWave("top",.5*game.width,"enemy_sectoid","pawn",6,300,1,2)},level1.second11=function(){getNewEnemyWave("top",.7*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second12=function(){getNewEnemyWave("left",.2*game.height,"enemy_sectoid","pawn",3,300,1,2)},level1.second13=function(){getNewEnemy(.3*game.width,game.outerTop,155,Math.PI/2,10,"base","enemy_base_floater",1)},level1.second15=function(){getNewEnemyWave("top",.2*game.width,"enemy_sectoid","pawn",2,300,1,2)},level1.second16=function(){getNewEnemyWave("top",.4*game.width,"enemy_sectoid","pawn",3,300,1,2)},level1.second17=function(){getNewEnemyWave("top",.6*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second18=function(){getNewEnemyWave("top",.8*game.width,"enemy_sectoid","pawn",5,300,1,2)},level1.second22=function(){getNewEnemyWave("top",.3*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second25=function(){getNewEnemyWave("left",.4*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second27=function(){getNewEnemyWave("right",.3*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second30=function(){getNewEnemyWave("top",.3*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second33=function(){getNewEnemyWave("top",.6*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second35=function(){getNewEnemyWave("right",.2*game.width,"enemy_sectoid","pawn",4,300,1,2)},level1.second37=function(){getNewEnemy(.2*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second38=function(){getNewEnemy(.4*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second39=function(){getNewEnemy(.6*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second40=function(){getNewEnemy(.8*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second41=function(){getNewEnemy(.5*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second42=function(){getNewEnemy(.2*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second43=function(){getNewEnemy(.4*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second44=function(){getNewEnemy(.6*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.second45=function(){getNewEnemy(.8*game.width,game.outerTop,80,Math.PI/2,10,"miniboss","enemy_floater",2)},level1.update=function(){game.seconds>13&&game.tracks.length<2&&game.enemies.length>0&&!game.bossDead&&game.music&&(game.tracks.push(game.soundTracks["tune2"+fileFormat]),game.tracks[1].play(),game.tracks[1].loop=!0),game.seconds>50&&0===game.enemies.length&&!game.bossDead&&(game.music&&(game.tracks.push(game.soundTracks["boss"+fileFormat]),game.tracks[2].play(),game.tracks[2].loop=!0),game.enemies.push(new boss(.3*game.width,game.outerTop,150,Math.PI/2,100,"boss_sectoid"))),game.seconds>55&&0===game.enemies.length&&game.bossDead&&3==game.tracks.length&&(game.tracks[0].pause(),game.tracks[1].pause(),game.tracks[2].pause(),game.tracks=[],game.music&&0===game.tracks.length&&game.tracks.push(game.soundTracks["victory"+fileFormat]),game.tracks[0].play())},$(document).keydown(function(a){game.keys[a.keyCode?a.keyCode:a.which]=!0}),$(document).keyup(function(a){delete game.keys[a.keyCode?a.keyCode:a.which]});var loadingBar=$("#loadingBar"),loadingBarFiller=$("#loadingBarFiller"),loadingText=new text("Loading Images.. ","",!1);loadingText["switch"]("on"),loadingBar.show(),win.addEventListener("load",windowLoadEvent,!1);var audiopreload=!1,timeout,waitTime=1e3,audioTest=new Audio;".mp3"===fileFormat?audioTest.src="data:audio/mpeg;base64,//MUxAAB6AXgAAAAAPP+c6nf//yi/6f3//MUxAMAAAIAAAjEcH//0fTX6C9Lf//0//MUxA4BeAIAAAAAAKX2/6zv//+IlR4f//MUxBMCMAH8AAAAABYWalVMQU1FMy45//MUxBUB0AH0AAAAADkuM1VVVVVVVVVV//MUxBgBUATowAAAAFVVVVVVVVVVVVVV":".m4a"===fileFormat?audioTest.src="data:audio/x-m4a;base64,AAAAGGZ0eXBNNEEgAAACAGlzb21pc28yAAAACGZyZWUAAAAfbWRhdN4EAABsaWJmYWFjIDEuMjgAAAFoAQBHAAACiG1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAYAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAG0dHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAYAAAAAAAAAAAAAAAAAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAABUG1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAArEQAAAQAVcQAAAAAAC1oZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU291bmRIYW5kbGVyAAAAAPttaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAL9zdGJsAAAAW3N0c2QAAAAAAAAAAQAAAEttcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAACdlc2RzAAAAAAMZAAEABBFAFQAAAAABftAAAAAABQISCAYBAgAAABhzdHRzAAAAAAAAAAEAAAABAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAXAAAAAQAAABRzdGNvAAAAAAAAAAEAAAAoAAAAYHVkdGEAAABYbWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAraWxzdAAAACOpdG9vAAAAG2RhdGEAAAABAAAAAExhdmY1Mi42NC4y":".ogg"===fileFormat&&(audioTest.src="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAD/QwAAAAAAAM2LVKsBHgF2b3JiaXMAAAAAAUSsAAAAAAAAgLsAAAAAAAC4AU9nZ1MAAAAAAAAAAAAA/0MAAAEAAADmvOe6Dy3/////////////////MgN2b3JiaXMdAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAwNzA2MjIAAAAAAQV2b3JiaXMfQkNWAQAAAQAYY1QpRplS0kqJGXOUMUaZYpJKiaWEFkJInXMUU6k515xrrLm1IIQQGlNQKQWZUo5SaRljkCkFmVIQS0kldBI6J51jEFtJwdaYa4tBthyEDZpSTCnElFKKQggZU4wpxZRSSkIHJXQOOuYcU45KKEG4nHOrtZaWY4updJJK5yRkTEJIKYWSSgelU05CSDWW1lIpHXNSUmpB6CCEEEK2IIQNgtCQVQAAAQDAQBAasgoAUAAAEIqhGIoChIasAgAyAAAEoCiO4iiOIzmSY0kWEBqyCgAAAgAQAADAcBRJkRTJsSRL0ixL00RRVX3VNlVV9nVd13Vd13UgNGQVAAABAEBIp5mlGiDCDGQYCA1ZBQAgAAAARijCEANCQ1YBAAABAABiKDmIJrTmfHOOg2Y5aCrF5nRwItXmSW4q5uacc845J5tzxjjnnHOKcmYxaCa05pxzEoNmKWgmtOacc57E5kFrqrTmnHPGOaeDcUYY55xzmrTmQWo21uaccxa0pjlqLsXmnHMi5eZJbS7V5pxzzjnnnHPOOeecc6oXp3NwTjjnnHOi9uZabkIX55xzPhmne3NCOOecc84555xzzjnnnHOC0JBVAAAQAABBGDaGcacgSJ+jgRhFiGnIpAfdo8MkaAxyCqlHo6ORUuoglFTGSSmdIDRkFQAACAAAIYQUUkghhRRSSCGFFFKIIYYYYsgpp5yCCiqppKKKMsoss8wyyyyzzDLrsLPOOuwwxBBDDK20EktNtdVYY62555xrDtJaaa211koppZRSSikIDVkFAIAAABAIGWSQQUYhhRRSiCGmnHLKKaigAkJDVgEAgAAAAgAAADzJc0RHdERHdERHdERHdETHczxHlERJlERJtEzL1ExPFVXVlV1b1mXd9m1hF3bd93Xf93Xj14VhWZZlWZZlWZZlWZZlWZZlWYLQkFUAAAgAAIAQQgghhRRSSCGlGGPMMeegk1BCIDRkFQAACAAgAAAAwFEcxXEkR3IkyZIsSZM0S7M8zdM8TfREURRN01RFV3RF3bRF2ZRN13RN2XRVWbVdWbZt2dZtX5Zt3/d93/d93/d93/d93/d1HQgNWQUASAAA6EiOpEiKpEiO4ziSJAGhIasAABkAAAEAKIqjOI7jSJIkSZakSZ7lWaJmaqZneqqoAqEhqwAAQAAAAQAAAAAAKJriKabiKaLiOaIjSqJlWqKmaq4om7Lruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7rui4QGrIKAJAAANCRHMmRHEmRFEmRHMkBQkNWAQAyAAACAHAMx5AUybEsS9M8zdM8TfRET/RMTxVd0QVCQ1YBAIAAAAIAAAAAADAkw1IsR3M0SZRUS7VUTbVUSxVVT1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTVN0zRNIDRkJQAABADAYo3B5SAhJSXl3hDCEJOeMSYhtV4hBJGS3jEGFYOeMqIMct5C4xCDHggNWREARAEAAMYgxxBzyDlHqZMSOeeodJQa5xyljlJnKcWYYs0oldhSrI1zjlJHraOUYiwtdpRSjanGAgAAAhwAAAIshEJDVgQAUQAAhDFIKaQUYow5p5xDjCnnmHOGMeYcc44556B0UirnnHROSsQYc445p5xzUjonlXNOSiehAACAAAcAgAALodCQFQFAnACAQZI8T/I0UZQ0TxRFU3RdUTRd1/I81fRMU1U90VRVU1Vt2VRVWZY8zzQ901RVzzRV1VRVWTZVVZZFVdVt03V123RV3ZZt2/ddWxZ2UVVt3VRd2zdV1/Zd2fZ9WdZ1Y/I8VfVM03U903Rl1XVtW3VdXfdMU5ZN15Vl03Vt25VlXXdl2fc103Rd01Vl2XRd2XZlV7ddWfZ903WF35VlX1dlWRh2XfeFW9eV5XRd3VdlVzdWWfZ9W9eF4dZ1YZk8T1U903RdzzRdV3VdX1dd19Y105Rl03Vt2VRdWXZl2fddV9Z1zzRl2XRd2zZdV5ZdWfZ9V5Z13XRdX1dlWfhVV/Z1WdeV4dZt4Tdd1/dVWfaFV5Z14dZ1Ybl1XRg+VfV9U3aF4XRl39eF31luXTiW0XV9YZVt4VhlWTl+4ViW3feVZXRdX1ht2RhWWRaGX/id5fZ943h1XRlu3efMuu8Mx++k+8rT1W1jmX3dWWZfd47hGDq/8OOpqq+brisMpywLv+3rxrP7vrKMruv7qiwLvyrbwrHrvvP8vrAso+z6wmrLwrDatjHcvm4sv3Acy2vryjHrvlG2dXxfeArD83R1XXlmXcf2dXTjRzh+ygAAgAEHAIAAE8pAoSErAoA4AQCPJImiZFmiKFmWKIqm6LqiaLqupGmmqWmeaVqaZ5qmaaqyKZquLGmaaVqeZpqap5mmaJqua5qmrIqmKcumasqyaZqy7LqybbuubNuiacqyaZqybJqmLLuyq9uu7Oq6pFmmqXmeaWqeZ5qmasqyaZquq3meanqeaKqeKKqqaqqqraqqLFueZ5qa6KmmJ4qqaqqmrZqqKsumqtqyaaq2bKqqbbuq7Pqybeu6aaqybaqmLZuqatuu7OqyLNu6L2maaWqeZ5qa55mmaZqybJqqK1uep5qeKKqq5ommaqqqLJumqsqW55mqJ4qq6omea5qqKsumatqqaZq2bKqqLZumKsuubfu+68qybqqqbJuqauumasqybMu+78qq7oqmKcumqtqyaaqyLduy78uyrPuiacqyaaqybaqqLsuybRuzbPu6aJqybaqmLZuqKtuyLfu6LNu678qub6uqrOuyLfu67vqucOu6MLyybPuqrPq6K9u6b+sy2/Z9RNOUZVM1bdtUVVl2Zdn2Zdv2fdE0bVtVVVs2TdW2ZVn2fVm2bWE0Tdk2VVXWTdW0bVmWbWG2ZeF2Zdm3ZVv2ddeVdV/XfePXZd3murLty7Kt+6qr+rbu+8Jw667wCgAAGHAAAAgwoQwUGrISAIgCAACMYYwxCI1SzjkHoVHKOecgZM5BCCGVzDkIIZSSOQehlJQy5yCUklIIoZSUWgshlJRSawUAABQ4AAAE2KApsThAoSErAYBUAACD41iW55miatqyY0meJ4qqqaq27UiW54miaaqqbVueJ4qmqaqu6+ua54miaaqq6+q6aJqmqaqu67q6Lpqiqaqq67qyrpumqqquK7uy7Oumqqqq68quLPvCqrquK8uybevCsKqu68qybNu2b9y6ruu+7/vCka3rui78wjEMRwEA4AkOAEAFNqyOcFI0FlhoyEoAIAMAgDAGIYMQQgYhhJBSSiGllBIAADDgAAAQYEIZKDRkRQAQJwAAGEMppJRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkgppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkqppJRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoplVJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSCgCQinAAkHowoQwUGrISAEgFAACMUUopxpyDEDHmGGPQSSgpYsw5xhyUklLlHIQQUmktt8o5CCGk1FJtmXNSWosx5hgz56SkFFvNOYdSUoux5ppr7qS0VmuuNedaWqs115xzzbm0FmuuOdecc8sx15xzzjnnGHPOOeecc84FAOA0OACAHtiwOsJJ0VhgoSErAYBUAAACGaUYc8456BBSjDnnHIQQIoUYc845CCFUjDnnHHQQQqgYc8w5CCGEkDnnHIQQQgghcw466CCEEEIHHYQQQgihlM5BCCGEEEooIYQQQgghhBA6CCGEEEIIIYQQQgghhFJKCCGEEEIJoZRQAABggQMAQIANqyOcFI0FFhqyEgAAAgCAHJagUs6EQY5Bjw1BylEzDUJMOdGZYk5qMxVTkDkQnXQSGWpB2V4yCwAAgCAAIMAEEBggKPhCCIgxAABBiMwQCYVVsMCgDBoc5gHAA0SERACQmKBIu7iALgNc0MVdB0IIQhCCWBxAAQk4OOGGJ97whBucoFNU6iAAAAAAAAwA4AEA4KAAIiKaq7C4wMjQ2ODo8AgAAAAAABYA+AAAOD6AiIjmKiwuMDI0Njg6PAIAAAAAAAAAAICAgAAAAAAAQAAAAICAT2dnUwAE7AwAAAAAAAD/QwAAAgAAADuydfsFAQEBAQEACg4ODg=="),
audioTest.preload="auto",audioTest.addEventListener("loadeddata",testpreload),timeout=setTimeout(testpreload,waitTime),win.requestAnimFrame=function(){return win.requestAnimationFrame||win.webkitRequestAnimationFrame||win.mozRequestAnimationFrame||win.oRequestAnimationFrame||win.msRequestAnimationFrame||function(a){win.setTimeout(a,1e3/30)}}();